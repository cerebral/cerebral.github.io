<!DOCTYPE html>
<html>
  <head>
    <title>Cerebral Docs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
<link rel="stylesheet" href="/main.css" />
<link rel="stylesheet" href="/prism.css" />
<link rel="stylesheet" href="/docs.css" />
  </head>
  <body>
    <div id="app"><div class="docs-container"><div id="navigation" class="docs-navigation"><ul class="docs-navigation-menu"><li class="docs-navigation-item active"><a href="/docs/get_started">get started</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/developer_guide">developer guide</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/packages">packages</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/migration">migration</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/api">api</a><div class="underline"></div></li></ul><div class="docs-search"><input type="text" id="search-docs" placeholder="search..."/><div id="search-result" class="docs-search-result"></div></div><div class="docs-icons"><a href="https://github.com/cerebral/cerebral" class="docs-icon" target="_new"><div class="docs-icon-github"></div>github repo</a><a href="https://discord.gg/0kIweV4bd2bwwsvH" class="docs-icon" target="_new"><div class="docs-icon-discord"></div>chat</a></div></div><div id="navigation-mobile" class="docs-navigation mobile"><div id="hamburger" class="docs-navigation-hamburger">☰</div><div class="docs-navigation-title mobile">get started</div><div class="docs-navigation-float mobile"><ul class="docs-navigation-menu mobile"><li class="docs-navigation-item active mobile"><a href="/docs/get_started">get started</a><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="/docs/get_started/index.html">Cerebral</a></li><li><a href="/docs/get_started/debugger.html">Debugger</a></li><li class="active"><a href="/docs/get_started/the_architecture.html">The architecture</a><ul><li><a href="#store-state">Store state</a><ul><li><a href="#simple-and-consistent-api">Simple and consistent API</a></li><li><a href="#optimized-rendering">Optimized rendering</a></li></ul></li><li><a href="#render-state">Render state</a></li><li><a href="#update-state">Update state</a></li><li><a href="#summary">Summary</a></li></ul></li><li><a href="/docs/get_started/resources.html">Resources</a></li><li><a href="/docs/get_started/counter.html">Example: Counter</a></li></ul></div></div></li><li class="docs-navigation-item mobile"><a href="/docs/developer_guide">developer guide</a></li><li class="docs-navigation-item mobile"><a href="/docs/packages">packages</a></li><li class="docs-navigation-item mobile"><a href="/docs/migration">migration</a></li><li class="docs-navigation-item mobile"><a href="/docs/api">api</a></li></ul></div></div><div class="docs-content"><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="/docs/get_started/index.html">Cerebral</a></li><li><a href="/docs/get_started/debugger.html">Debugger</a></li><li class="active"><a href="/docs/get_started/the_architecture.html">The architecture</a><ul><li><a href="#store-state">Store state</a><ul><li><a href="#simple-and-consistent-api">Simple and consistent API</a></li><li><a href="#optimized-rendering">Optimized rendering</a></li></ul></li><li><a href="#render-state">Render state</a></li><li><a href="#update-state">Update state</a></li><li><a href="#summary">Summary</a></li></ul></li><li><a href="/docs/get_started/resources.html">Resources</a></li><li><a href="/docs/get_started/counter.html">Example: Counter</a></li></ul></div></div><div class="docs-doc"><div class="docs-doc-content"><div class="docs-doc-edit"><a href="https://github.com/cerebral/cerebral/tree/master/docs/docs/docs/get_started/the_architecture.md" target="_new">Edit on Github</a></div><h1 id="the-architecture">The architecture</h1><p>Cerebral is based on the simple concept of three things your application does in order to function. <strong>Store state</strong>, <strong>render state</strong> and <strong>update state</strong>.</p><h2 id="store-state">Store state</h2><p>Where to store the state of an application is a highly debated subject. Should we allow the components to store state? Should we have multiple models? Stores? Reducers? Services? There are many concepts that can store state. In Cerebral you store all your state in “a single state tree”. That means you do not create classes or other abstractions around state, it is all basically one big object of plain JavaScript types. Objects, arrays, strings, numbers and booleans:</p><pre><code class="language-js">{
  auth: {
    isLoggedIn: false,
    user: {}
  },
  posts: {
    list: [],
    selectedPostIndex: 0
  }
}</code></pre><p>With this approach we get some benefits not possible with other approaches.</p><h3 id="simple-and-consistent-api">Simple and consistent API</h3><p>Typically a state update changes a value, pushes an item in a list or merges an object into another. With a single state tree we can create an API that does exactly that:</p><pre><code class="language-js">state.set(&#x27;user.prefs.style&#x27;, &#x27;dark&#x27;)
state.push(&#x27;user.friends&#x27;, &#x27;Joe&#x27;)
state.merge(&#x27;user.info&#x27;, {
  email: &#x27;cheetah@jungle.com&#x27;,
  name: &#x27;Cheetah&#x27;
})</code></pre><p>With a single state tree we can point to parts of the state using paths (the first argument). We use dot notation to point to nested paths, like <strong>auth.user.name</strong>.</p><h3 id="optimized-rendering">Optimized rendering</h3><p>Cerebral does not look at the updates in your application as “value updates”, but as “path updates”. This allows Cerebral to make optimizations not possible in other frameworks:</p><ol><li>There is no need for immutability in Cerebral because a change to a path means that any component depending on that path should render (no value comparison). In applications with large data structures immutability has a high cost. There is no need to hack objects and arrays to observe changes to them either. There is nothing special about the state you put into Cerebrals state tree</li><li>Since there is no value comparison in Cerebral it uses what we call <strong>strict render</strong>. This allows us to do render optimizations not possible with other solutions. For example you can say that a component depending on a list is only interested in added/removed items of the list or if the list itself is being replaced</li></ol><h2 id="render-state">Render state</h2><p>Since Cerebral stores all the state of the application in a single state tree we need a way to expose that state to the components. In some frameworks this is done by passing the whole model or collection of models/stores from the top of the application and down from one component to the next. This can become very tedious and fragile as all nested components completely depend on their parent. In Cerebral the state of the application is directly connected to each component:</p><pre><code class="language-js">connect({
  userName: state`app.user.name`
},
  function User(props) {
    props.userName // &quot;some name&quot; (value stored in &#x27;app.user.name&#x27;)
  }
)</code></pre><p><strong>connect</strong> tells Cerebral that the component is interested in a path where the user name happens to be. When that path changes the component will render. The component is now completely independent of other components. You can move it wherever you want in the component tree and it will still work.</p><h2 id="update-state">Update state</h2><p>This is where Cerebral really differs from other approaches to application development. Updating the state of an application can be anything from:</p><ul><li>flipping a <strong>true</strong> to a <strong>false</strong></li><li>setting some value, like a filter</li><li>reading (and storing) something in local storage</li><li>requesting data from the server and, depending on the status code of the response, do something with that response which might lead to new requests and/or setting up a listener for data on the server</li><li>etc…</li></ul><p>The point is, updating state can be a very complex flow of operations. This is often where spaghetti code comes from and we use abstractions to hide it. The problem with abstractions is that it is very difficult to understand how things actually work and it becomes more difficult to make changes.</p><p>To handle everything from a simple toggle to very complex operations, Cerebral has the concept of <strong>signals</strong>. Signals allows you to compose functions together into a flow that is not only about the “happy path” but properly takes the actual paths of execution into account, them being errors or other reasons to diverge execution. You can define many different execution paths based on whatever you want (a status code, an error, some state, etc). This allows you to write decoupled code, while still bringing everything together in the form of a higher abstraction which greatly helps understanding how things relate to one another (in what order they will run, when they will run, etc). Under the hood, signals are based on <a href="https://github.com/cerebral/function-tree" target="new">function-tree</a>, a project that came out of the initial experimentations in the first version of Cerebral.</p><p>Another powerful feature of <strong>signals</strong> (aka function-tree) is that there is a debugger that can track execution and understands when a signal triggers, what functions are run, what state is being updated and what other side effects are triggered.</p><h2 id="summary">Summary</h2><p>The architecture of Cerebral is driven by the goal to give you insight. The single state tree and the way state is connected to the components all support this vision. Creating a Cerebral application allows you and your team members to never question what actually happens when a page loads, a specific button is clicked, etc. Decoupling of state, components and state updates also makes it an overall better experience when scaling up an application as the components will be just a dumb layer that transforms a given state to a user interface.</p></div></div></div><div style="z-index:99;background-color:#DD4A68;color:#fff;padding:5px 10px;position:fixed;width:100%;bottom:0;left:0;">Docs are still being written and might not be up to date with API</div></div></div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
<script src="/search.js"></script>
<script src="/mobile.js"></script>
  </body>
</html>
