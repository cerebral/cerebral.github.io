<!DOCTYPE html>
<html>
  <head>
    <title>Cerebral Docs</title>
    
<link rel="stylesheet" href="/main.css" />
<link rel="stylesheet" href="/prism.css" />
<link rel="stylesheet" href="/docs.css" />
  </head>
  <body>
    <div id="app"><div class="docs-container"><div id="navigation" class="docs-navigation"><ul class="docs-navigation-menu"><li class="docs-navigation-item"><span>install</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/install/index.html">Cerebral</a><a class="docs-navigation-subItem" href="/docs/install/boilerplate.html">Boilerplates</a><a class="docs-navigation-subItem" href="/docs/install/tools.html">Tools</a><a class="docs-navigation-subItem" href="/docs/install/function_tree.html">Function Tree</a></div></li><li class="docs-navigation-item"><span>tutorial</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/tutorial/index.html">Introduction</a><a class="docs-navigation-subItem" href="/docs/tutorial/define_state.html">Define State</a><a class="docs-navigation-subItem" href="/docs/tutorial/render_state.html">Render state</a><a class="docs-navigation-subItem" href="/docs/tutorial/update_state.html">Update state</a><a class="docs-navigation-subItem" href="/docs/tutorial/chains.html">Chains</a><a class="docs-navigation-subItem" href="/docs/tutorial/actions.html">Actions</a><a class="docs-navigation-subItem" href="/docs/tutorial/async_actions.html">Async actions</a><a class="docs-navigation-subItem" href="/docs/tutorial/paths.html">Paths</a><a class="docs-navigation-subItem" href="/docs/tutorial/compute_state.html">Compute state</a><a class="docs-navigation-subItem" href="/docs/tutorial/providers.html">Providers</a><a class="docs-navigation-subItem" href="/docs/tutorial/routing.html">Routing</a><a class="docs-navigation-subItem" href="/docs/tutorial/modules.html">Modules</a></div></li><li class="docs-navigation-item"><span>in depth</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/in_depth/index.html">The architecture</a><a class="docs-navigation-subItem" href="/docs/in_depth/controller.html">Controller</a><a class="docs-navigation-subItem" href="/docs/in_depth/state.html">State</a><a class="docs-navigation-subItem" href="/docs/in_depth/signals.html">Signals</a><a class="docs-navigation-subItem" href="/docs/in_depth/chains_and_paths.html">Chains and paths</a><a class="docs-navigation-subItem" href="/docs/in_depth/actions.html">Actions</a><a class="docs-navigation-subItem" href="/docs/in_depth/providers.html">Providers</a><a class="docs-navigation-subItem" href="/docs/in_depth/tags.html">Tags</a><a class="docs-navigation-subItem" href="/docs/in_depth/operators.html">Operators</a><a class="docs-navigation-subItem" href="/docs/in_depth/factories.html">Factories</a><a class="docs-navigation-subItem" href="/docs/in_depth/connect.html">Connect</a><a class="docs-navigation-subItem" href="/docs/in_depth/compute.html">Compute</a><a class="docs-navigation-subItem" href="/docs/in_depth/routing.html">Routing</a></div></li><li class="docs-navigation-item active"><span>best practices</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/best_practices/index.html">Organizing</a><a class="docs-navigation-subItem" href="/docs/best_practices/constants.html">Constants</a><a class="docs-navigation-subItem" href="/docs/best_practices/testing.html">Testing</a><a class="docs-navigation-subItem" href="/docs/best_practices/load_initial_data.html">Load initial data</a><a class="docs-navigation-subItem" href="/docs/best_practices/storing_server_data.html">Storing server data</a><a class="docs-navigation-subItem active" href="/docs/best_practices/lists.html">Lists</a><a class="docs-navigation-subItem" href="/docs/best_practices/modals.html">Modals</a><a class="docs-navigation-subItem" href="/docs/best_practices/feedback_messages.html">Feedback messages</a><a class="docs-navigation-subItem" href="/docs/best_practices/popups.html">Popups</a><a class="docs-navigation-subItem" href="/docs/best_practices/long_running_side_effects.html">Long running side effects</a><a class="docs-navigation-subItem" href="/docs/best_practices/server_side.html">Server side</a></div></li><li class="docs-navigation-item"><span>migration</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/migration/index.html">From 1.x to 2.x</a></div></li><li class="docs-navigation-item"><span>api</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/api/index.html">Controller</a><a class="docs-navigation-subItem" href="/docs/api/state.html">State</a><a class="docs-navigation-subItem" href="/docs/api/signals.html">Signals</a><a class="docs-navigation-subItem" href="/docs/api/tags.html">Tags</a><a class="docs-navigation-subItem" href="/docs/api/connect.html">Connect</a><a class="docs-navigation-subItem" href="/docs/api/modules.html">Modules</a><a class="docs-navigation-subItem" href="/docs/api/operators.html">Operators</a><a class="docs-navigation-subItem" href="/docs/api/providers.html">Providers</a><a class="docs-navigation-subItem" href="/docs/api/compute.html">Compute</a><a class="docs-navigation-subItem" href="/docs/api/router.html">Router</a></div></li></ul><div class="docs-search"><input type="text" id="search-docs" placeholder="search..."/><div id="search-result" class="docs-search-result"></div></div></div><div class="docs-content"><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="#lists">Lists</a><ul><li><a href="#computing-lists">Computing lists</a></li><li><a href="#identifying-current-item">Identifying current item</a></li></ul></li></ul></div></div><div class="docs-doc"><div class="docs-doc-edit"><a href="https://github.com/cerebral/cerebral/tree/master/docs/docs/docs/best_practices/lists.md" target="_new">Edit on Github</a></div><div class="docs-doc-content"><div style="background-color:#DD4A68;color:#fff;margin:10px;padding:5px 10px;border-radius:3px;">Docs are still being written and might not be up to date with API</div><h1 id="lists">Lists</h1><p>Typically when working with lists you would:</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import {state} from &#x27;cerebral/tags&#x27;

export default connect({
  items: state`app.items`
},
  function Items(props) {
    return (
      &lt;ul&gt;
        {props.items.map((item, index) =&gt; {
          &lt;Item key={index} item={item} /&gt;
        })}
      &lt;/ul&gt;
    )
  }
)</code></pre><p>This is perfectly okay if the list is not very large or the list is not related to entities (objects with ids). But when working with Cerebral and entities you should favor storing them as a map instead. That means:</p><pre><code class="language-js">{
  items: {
    id1: {},
    id2: {},
    id3: {}
  }
}</code></pre><p>This gives you three benefits:</p><ol><li>If you give each item a client side id, for example using <a href="https://www.npmjs.com/package/uuid" target="new">uuid</a>, you can very easily optimistically add new items without worrying about their place in some list. They will get a client side id and can always be referenced by that</li><li>It will be faster and less code to look up entities when you have an id to reference them with. You just point to <strong>items.id2</strong> and you have the item. No array search</li><li>Your components can connect directly to an entity</li></ol><p>So let us imagine we have a map of items instead:</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import {state} from &#x27;cerebral/tags&#x27;

export default connect({
  items: state`app.items`
},
  function List(props) {
    return (
      &lt;ul&gt;
        {Object.keys(props.items).map((itemKey) =&gt; {
          &lt;Item key={itemKey} itemKey={itemKey} /&gt;
        })}
      &lt;/ul&gt;
    )
  }
)</code></pre><p>We are now giving the component only a reference to the item it should connect to. That means inside our <strong>Item</strong> component:</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import {state, props} from &#x27;cerebral/tags&#x27;

export default connect((props) =&gt; ({
  item: state`app.items.${props`itemKey`}`
}),
  function Item(props) {
    return (
      &lt;div&gt;
        {props.item.title}
      &lt;/div&gt;
    )
  }
)</code></pre><p>This component is now optimized, it is more explicit about where it gets its state from and you also got the other benefits mentioned above.</p><h2 id="computing-lists">Computing lists</h2><p>Typically you would put a computed in between the component and the items, for sorting and filtering reasons, only returning the keys. For example, returning the keys in sorted order by <em>datetime</em>:</p><pre><code class="language-js">import {compute} from &#x27;cerebral&#x27;
import {state} from &#x27;cerebral/tags&#x27;

export default compute(
  state`app.items`
  (items) =&gt; {
  return Object.keys(items)
    .sort((itemAKey, itemBKey) =&gt; {
      const itemA = items[itemAKey]
      const itemB = items[itemBKey]

      if (itemA.datetime &gt; itemB.datetime) {
        return 1
      } else if (itemA.datetime &lt; itemB.datetime) {
        return -1
      }

      return 0
    })
  }
)</code></pre><p>Now in the component you just do:</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import itemsKeys from &#x27;../computed/itemsKeys&#x27;

export default connect({
  itemsKeys
},
  function List(props) {
    return (
      &lt;ul&gt;
        {props.itemsKeys.map((itemKey) =&gt; {
          &lt;Item key={itemKey} itemKey={itemKey} /&gt;
        })}
      &lt;/ul&gt;
    )
  }
)</code></pre><h2 id="identifying-current-item">Identifying current item</h2><p>Sometimes you want to highlight the current item in a list. You might be tempted to add this logic in the <strong>Item</strong> components:</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import {state, props} from &#x27;cerebral/tags&#x27;

export default connect((props) =&gt; ({
  item: state`app.items.${props`itemKey`}`,
  currentItemKey: state`app.currentItemKey`
}),
  function Item(props) {
    return (
      &lt;div className={`item ${props.itemKey === props.currentItemKey} ? &#x27;selected&#x27; : &#x27;&#x27;`}&gt;
        {props.item.title}
      &lt;/div&gt;
    )
  }
)</code></pre><p>But this will make every item in the list render again when <strong>app.currentItemKey</strong> changes. A better approach is to rather make the parent component handling the list check this:</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import itemsKeys from &#x27;../computed/itemsKeys&#x27;
import {state} from &#x27;cerebral/tags&#x27;

export default connect({
  itemsKeys,
  currentItemKey state`app.currentItemKey`
},
  function List(props) {
    return (
      &lt;ul&gt;
        {props.itemsKeys.map((itemKey) =&gt; {
          &lt;Item
            key={itemKey}
            itemKey={itemKey}
            selected={itemKey === props.currentItemKey}
          /&gt;
        })}
      &lt;/ul&gt;
    )
  }
)</code></pre><p>Now only the component that actually changes its <strong>selected</strong> prop will do a new render.</p><p>Lists are the UI output that affects performance the most. Usually it is no problem with over-rendering, cause there are no changes to the DOM anyways, but on big lists React/Inferno can get into problems if it is not optimized. Luckily Cerebral does this for you when you follow this convention.</p></div></div></div><div class="docs-footer"><div class="docs-footer-column"><div class="docs-footer-header">ORGANIZATION</div><a class="docs-footer-link" href="https://github.com/cerebral/cerebral/graphs/contributors" target="_new">Contributors</a><a class="docs-footer-link" href="http://www.webpackbin.com" target="_new">www.webpackbin.com</a><a class="docs-footer-link" href="http://www.christianalfoni.com" target="_new">www.christianalfoni.com</a></div><div class="docs-footer-column"><div class="docs-footer-header">ARTICLES AND USEFUL LINKS</div><a class="docs-footer-link" href="http://medium.com/p/5793c08db2cc" target="_new">The story of Cerebral</a><a class="docs-footer-link" href="https://gist.github.com/christianalfoni/b08a99faa09df054afe87528a2134730" target="_new">An unlikely success story</a></div><div class="docs-footer-column"><div class="docs-footer-header">HELP</div><a class="docs-footer-link" href="https://github.com/cerebral/cerebral" target="_new">Cerebral github repo</a><a class="docs-footer-link" href="https://discord.gg/0kIweV4bd2bwwsvH" target="_new">Discoard chat</a></div></div></div></div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
<script src="/search.js"></script>
<script src="/scroll-detect.js"></script>
  </body>
</html>
