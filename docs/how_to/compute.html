<!DOCTYPE html>
<html>
  <head>
    <title>Cerebral Docs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
<link rel="stylesheet" href="/main.css" />
<link rel="stylesheet" href="/prism.css" />
<link rel="stylesheet" href="/docs.css" />
  </head>
  <body>
    <div id="app"><div class="docs-container"><div id="navigation" class="docs-navigation"><ul class="docs-navigation-menu"><li class="docs-navigation-item"><a href="/docs/get_started">get started</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/tutorial">tutorial</a><div class="underline"></div></li><li class="docs-navigation-item active"><a href="/docs/how_to">how to</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/migration">migration</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/api">api</a><div class="underline"></div></li></ul><div class="docs-search"><input type="text" id="search-docs" placeholder="search..."/><div id="search-result" class="docs-search-result"></div></div><div class="docs-icons"><a href="https://github.com/cerebral/cerebral" class="docs-icon" target="_new"><div class="docs-icon-github"></div>github repo</a><a href="https://discord.gg/0kIweV4bd2bwwsvH" class="docs-icon" target="_new"><div class="docs-icon-discord"></div>chat</a></div></div><div id="navigation-mobile" class="docs-navigation mobile"><div id="hamburger" class="docs-navigation-hamburger">☰</div><div class="docs-navigation-title mobile">how to</div><div class="docs-navigation-float mobile"><ul class="docs-navigation-menu mobile"><li class="docs-navigation-item mobile"><a href="/docs/get_started">get started</a></li><li class="docs-navigation-item mobile"><a href="/docs/tutorial">tutorial</a></li><li class="docs-navigation-item active mobile"><a href="/docs/how_to">how to</a><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="/docs/how_to/index.html">Define state</a></li><li><a href="/docs/how_to/signals.html">Run signals</a></li><li><a href="/docs/how_to/actions.html">Create actions</a></li><li><a href="/docs/how_to/chains_and_paths.html">Use chains and paths</a></li><li><a href="/docs/how_to/providers.html">Add providers</a></li><li><a href="/docs/how_to/factories.html">Create factories</a></li><li><a href="/docs/how_to/connect.html">Connect components</a></li><li class="active"><a href="/docs/how_to/compute.html">Compute values</a><ul><li><a href="#getting-data">Getting data</a></li><li><a href="#composing">Composing</a></li></ul></li><li><a href="/docs/how_to/organize.html">Organize</a></li><li><a href="/docs/how_to/test.html">Test</a></li></ul></div></div></li><li class="docs-navigation-item mobile"><a href="/docs/migration">migration</a></li><li class="docs-navigation-item mobile"><a href="/docs/api">api</a></li></ul></div></div><div class="docs-content"><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="/docs/how_to/index.html">Define state</a></li><li><a href="/docs/how_to/signals.html">Run signals</a></li><li><a href="/docs/how_to/actions.html">Create actions</a></li><li><a href="/docs/how_to/chains_and_paths.html">Use chains and paths</a></li><li><a href="/docs/how_to/providers.html">Add providers</a></li><li><a href="/docs/how_to/factories.html">Create factories</a></li><li><a href="/docs/how_to/connect.html">Connect components</a></li><li class="active"><a href="/docs/how_to/compute.html">Compute values</a><ul><li><a href="#getting-data">Getting data</a></li><li><a href="#composing">Composing</a></li></ul></li><li><a href="/docs/how_to/organize.html">Organize</a></li><li><a href="/docs/how_to/test.html">Test</a></li></ul></div></div><div class="docs-doc"><div class="docs-doc-content"><div class="docs-doc-edit"><a href="https://github.com/cerebral/cerebral/tree/master/docs/docs/docs/how_to/compute.md" target="_new">Edit on Github</a></div><h1 id="compute-values">Compute values</h1><p>Normally you use state directly from the state tree, but sometimes you need to compute values. Typically filtering lists, grabbing the projects of a user or other derived state.</p><p>Cerebral allows you to compute state that can be used in multiple contexts. Let us look at the signature:</p><pre><code class="language-js">import {compute} from &#x27;cerebral&#x27;

export default compute(() =&gt; {
  return &#x27;foo&#x27;
})</code></pre><p>You can now use this with <strong>connect</strong>:</p><pre><code class="language-js">import computedFoo from &#x27;../computedFoo&#x27;

connect({
  foo: computedFoo
})</code></pre><p>You can use it with operators in a signal:</p><pre><code class="language-js">import computedFoo from &#x27;../computedFoo&#x27;
import {set} from &#x27;cerebral/operators&#x27;
import {state} from &#x27;cerebral/tags&#x27;

export default [
  set(state`foo`, computedFoo)
]</code></pre><p>Or you can resolve it inside an action if you need to:</p><pre><code class="language-js">import computedFoo from &#x27;../computedFoo&#x27;

function myAction ({resolve}) {
  const foo = resolve.value(computedFoo)
}</code></pre><p>You can even compose it into a Tag:</p><pre><code class="language-js">import computedFoo from &#x27;../computedFoo&#x27;
import {state} from &#x27;cerebral/tags&#x27;

state`${computedFoo}.bar`</code></pre><h2 id="getting-data">Getting data</h2><p>Compute can manually grab data related to where it is run. For example in <strong>connect</strong> you have access to both state and properties of the component. In a signal you would have access to state and the props to the signal. You do this by combining the <strong>get</strong> argument with a related tag:</p><pre><code class="language-js">import {compute} from &#x27;cerebral&#x27;
import {state, props} from &#x27;cerebral/tags&#x27;

export default compute((get) =&gt; {
  return get(state`foo`) + get(props`bar`)
})</code></pre><p>Cerebral now knows what paths this computed is interested in and can optimize its need to run again to produce a changed value.</p><h2 id="composing">Composing</h2><p>What makes compute very powerful is its ability to compose tags and other compute. Any tags you pass as arguments will be passed in as a value to the next function in line. The last argument of the function is always the <strong>get</strong> function.</p><pre><code class="language-js">import {compute} from &#x27;cerebral&#x27;
import {state, props} from &#x27;cerebral/tags&#x27;

const computedItemUsers = compute(
  state`items.${props`itemKey`}`,
  (item, get) =&gt; {
    return item.userIds.map((userId) =&gt; get(state`users.${userId}`))
  }
)

// In connect
connect({
  users: computedItemUsers
})</code></pre><p>It uses the <em>itemKey</em> property from the component to grab the actual item. Then it grab each user based on the userIds of the item. You can also compose multiple compute together.</p><pre><code class="language-js">connect({
  item: compute(filteredList, onlyAwesome)
})</code></pre><p>Here <em>filteredList</em> returns a list of filtered items, where <em>onlyAwesome</em> expects to receive a list and filters it again.</p><pre><code class="language-js">compute((list) =&gt; {
  return list.filter((item) =&gt; item.isAwesome)
})</code></pre><p>It is possible to combine tags and functions as many times as you would like:</p><pre><code class="language-js">compute(
  state`currentItemKey`,
  (currentItemKey, get) =&gt; {
    return get(state`item.${currentItemKey}`)
  },
  state`isAwesome`,
  (item, isAwesome) =&gt; {
    return item.isAwesome === isAwesome
  }
)</code></pre><p>Typically you get away with most things using Tags, but compute will help you with any other scenario where more “umph” is needed.</p></div></div></div><div style="z-index:99;background-color:#DD4A68;color:#fff;padding:5px 10px;position:fixed;width:100%;bottom:0;left:0;">Docs are still being written and might not be up to date with API</div></div></div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
<script src="/search.js"></script>
<script src="/mobile.js"></script>
  </body>
</html>
