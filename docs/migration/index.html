<!DOCTYPE html>
<html>
  <head>
    <title>Cerebral Docs</title>
    
<link rel="stylesheet" href="/main.css" />
<link rel="stylesheet" href="/prism.css" />
<link rel="stylesheet" href="/docs.css" />
  </head>
  <body>
    <div id="app"><div class="docs-container"><div id="navigation" class="docs-navigation"><ul class="docs-navigation-menu"><li class="docs-navigation-item"><span>install</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/install/index.html">Cerebral</a><a class="docs-navigation-subItem" href="/docs/install/debugger.html">Debugger</a><a class="docs-navigation-subItem" href="/docs/install/boilerplate.html">Boilerplates</a><a class="docs-navigation-subItem" href="/docs/install/tools.html">Tools</a><a class="docs-navigation-subItem" href="/docs/install/function_tree.html">Function Tree</a></div></li><li class="docs-navigation-item"><span>tutorial</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/tutorial/index.html">Introduction</a><a class="docs-navigation-subItem" href="/docs/tutorial/define_state.html">Define State</a><a class="docs-navigation-subItem" href="/docs/tutorial/render_state.html">Render state</a><a class="docs-navigation-subItem" href="/docs/tutorial/update_state.html">Update state</a><a class="docs-navigation-subItem" href="/docs/tutorial/chains.html">Chains</a><a class="docs-navigation-subItem" href="/docs/tutorial/actions.html">Actions</a><a class="docs-navigation-subItem" href="/docs/tutorial/async_actions.html">Async actions</a><a class="docs-navigation-subItem" href="/docs/tutorial/paths.html">Paths</a><a class="docs-navigation-subItem" href="/docs/tutorial/compute_state.html">Compute state</a><a class="docs-navigation-subItem" href="/docs/tutorial/providers.html">Providers</a><a class="docs-navigation-subItem" href="/docs/tutorial/routing.html">Routing</a><a class="docs-navigation-subItem" href="/docs/tutorial/modules.html">Modules</a></div></li><li class="docs-navigation-item"><span>in depth</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/in depth/index.html">The architecture</a><a class="docs-navigation-subItem" href="/docs/in depth/controller.html">Controller</a><a class="docs-navigation-subItem" href="/docs/in depth/state.html">State</a><a class="docs-navigation-subItem" href="/docs/in depth/signals.html">Signals</a><a class="docs-navigation-subItem" href="/docs/in depth/chains_and_paths.html">Chains and paths</a><a class="docs-navigation-subItem" href="/docs/in depth/actions.html">Actions</a><a class="docs-navigation-subItem" href="/docs/in depth/providers.html">Providers</a><a class="docs-navigation-subItem" href="/docs/in depth/tags.html">Tags</a><a class="docs-navigation-subItem" href="/docs/in depth/operators.html">Operators</a><a class="docs-navigation-subItem" href="/docs/in depth/factories.html">Factories</a><a class="docs-navigation-subItem" href="/docs/in depth/connect.html">Connect</a><a class="docs-navigation-subItem" href="/docs/in depth/compute.html">Compute</a><a class="docs-navigation-subItem" href="/docs/in depth/routing.html">Routing</a></div></li><li class="docs-navigation-item"><span>best practices</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/best practices/index.html">Organizing</a><a class="docs-navigation-subItem" href="/docs/best practices/constants.html">Constants</a><a class="docs-navigation-subItem" href="/docs/best practices/testing.html">Testing</a><a class="docs-navigation-subItem" href="/docs/best practices/load_initial_data.html">Load initial data</a><a class="docs-navigation-subItem" href="/docs/best practices/storing_server_data.html">Storing server data</a><a class="docs-navigation-subItem" href="/docs/best practices/lists.html">Lists</a><a class="docs-navigation-subItem" href="/docs/best practices/modals.html">Modals</a><a class="docs-navigation-subItem" href="/docs/best practices/feedback_messages.html">Feedback messages</a><a class="docs-navigation-subItem" href="/docs/best practices/popups.html">Popups</a><a class="docs-navigation-subItem" href="/docs/best practices/long_running_side_effects.html">Long running side effects</a><a class="docs-navigation-subItem" href="/docs/best practices/server_side.html">Server side</a></div></li><li class="docs-navigation-item active"><span>migration</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem active" href="/docs/migration/index.html">From 1.x to 2.x</a></div></li><li class="docs-navigation-item"><span>api</span><div class="underline"></div><div class="docs-navigation-subItems"><a class="docs-navigation-subItem" href="/docs/api/index.html">Controller</a><a class="docs-navigation-subItem" href="/docs/api/state.html">State</a><a class="docs-navigation-subItem" href="/docs/api/signals.html">Signals</a><a class="docs-navigation-subItem" href="/docs/api/tags.html">Tags</a><a class="docs-navigation-subItem" href="/docs/api/connect.html">Connect</a><a class="docs-navigation-subItem" href="/docs/api/modules.html">Modules</a><a class="docs-navigation-subItem" href="/docs/api/operators.html">Operators</a><a class="docs-navigation-subItem" href="/docs/api/providers.html">Providers</a><a class="docs-navigation-subItem" href="/docs/api/compute.html">Compute</a><a class="docs-navigation-subItem" href="/docs/api/router.html">Router</a></div></li></ul><div class="docs-search"><input type="text" id="search-docs" placeholder="search..."/><div id="search-result" class="docs-search-result"></div></div></div><div class="docs-content"><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="#from-1.x-to-2.x">From 1.x to 2.x</a><ul><li><a href="#controller">Controller</a></li><li><a href="#modules">Modules</a></li><li><a href="#operators">Operators</a></li><li><a href="#signals">Signals</a><ul><li><a href="#1.x">1.x</a></li><li><a href="#2.x">2.x</a></li></ul></li><li><a href="#actions">Actions</a><ul><li><a href="#1.x">1.x</a></li></ul></li><li><a href="#providers-(outdates-services)">Providers (outdates services)</a></li><li><a href="#views">Views</a></li><li><a href="#model">Model</a></li><li><a href="#strict-render-mode">Strict render mode</a></li><li><a href="#devtools">Devtools</a><ul><li><a href="#1.x">1.x</a></li><li><a href="#2.x">2.x</a></li></ul></li></ul></li></ul></div></div><div class="docs-doc"><div class="docs-doc-edit"><a href="https://github.com/cerebral/cerebral/edit/master/docs/docs/index.md" target="_new">Edit on Github</a></div><div class="docs-doc-content"><div style="background-color:#DD4A68;color:#fff;margin:10px;padding:5px 10px;border-radius:3px;">Docs are still being written and might not be up to date with API</div><h1 id="from-1.x-to-2.x">From 1.x to 2.x</h1><p>When migrating from 1.x to 2.x you need to take the following under consideration.</p><ul><li>There are no models left to choose from. Cerebral now comes with one model.</li><li>Services have been removed in favor of function-tree/providers.</li></ul><h2 id="controller">Controller</h2><p>Instead of choosing your model and connecting to the <em>Controller</em> as in 1.x as shown below</p><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;
import Model from &#x27;cerebral/models/immutable&#x27;

const controller = Controller(Model({
  // You can add some initial state here if you want
}))

export default controller</code></pre><p>You would simply do the following in 2.x</p><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;

const controller = Controller({
  state: {
    // You can add some initial state here if you want
  }
})

export default controller</code></pre><p><strong>controller.getSignals()</strong> is removed from 2.x so favor <strong>controller.getSignal(‘some.signal’)</strong> instead.</p><h2 id="modules">Modules</h2><p>In 1.x you would have done something like this</p><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;
import Model from &#x27;cerebral/models/immutable&#x27;

import Home from &#x27;./modules/Home&#x27;
import Admin from &#x27;./modules/Admin&#x27;

const controller = Controller(Model({}))

controller.addModules({
  home: Home,
  admin: Admin
})

export default controller</code></pre><p>In 2.x the modules are defined along with the controller</p><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;

import Home from &#x27;./modules/Home&#x27;
import Admin from &#x27;./modules/Admin&#x27;

const controller = Controller({
  modules: {
    home: Home(),
    admin: Admin()
  }
})

export default controller</code></pre><p>Sub-modules can be defined by each module in the same way (see below).</p><p>In 1.x you would create your own module like this</p><pre><code class="language-js">// 1.x
export default module =&gt; {
  module.addState({
    items: [],
    newItemTitle: &#x27;&#x27;,
    isSaving: false,
    error: null
  })

  module.addSignals({
    newItemTitleSubmitted: submitNewItemTitle
  })
}</code></pre><p>addState, addSignals have been removed, so in 2.x you simply return an object</p><pre><code class="language-js">// 2.x
export default {
  state: {
    items: [],
    newItemTitle: &#x27;&#x27;,
    isSaving: false,
    error: null
  },
  modules: {
    subModule: SubModule()
  },
  signals: {
    newItemTitleSubmitted: submitNewItemTitle
  }
}</code></pre><h2 id="operators">Operators</h2><p>The biggest change to Cerebral 2.x is the operators. You can read more about them in the Operators docs. They have become very powerful and you can create your own operators. Operators in Cerebral 2.x has been moved into core Cerebral. You can still use the old operators if you want by installing them via npm.</p><pre><code class="language-js">npm install cerebral-operators --save</code></pre><p>The new operators now use tagged template literals and you can reduce number of actions and instead use the new operators. Here is a quick sample. As you can see you import them from ‘cerebral/operators’</p><pre><code class="language-js">import {
  set // other operators include: wait, when, equals, debounce, push, pop, shift, toggle, unset, splice
} from &#x27;cerebral/operators&#x27;
import {
  state,
  input
} from &#x27;cerebral/tags&#x27;

export default [
  set(state`foo.bar`, input`bar`)
]</code></pre><h2 id="signals">Signals</h2><p>You handle signals mostly the same way as in 1.x. You can describe signals in a module or in the controller directly.</p><h3 id="1.x">1.x</h3><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;
import Model from &#x27;cerebral-model-immutable&#x27;
import doSomething from &#x27;./chains/doSomething&#x27;
import updateField from &#x27;./chains/updateField&#x27;

const controller = Controller(Model({}))

controller.addSignals({
  buttonClicked: doSomething,
  fieldChanged: { immediate: true, chain: updateField }
})</code></pre><h3 id="2.x">2.x</h3><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;
import doSomething from &#x27;./chains/doSomething&#x27;
import updateField from &#x27;./chains/updateField&#x27;

const controller = Controller({
  signals: {
    buttonClicked: doSomething,
    fieldChanged: updateField
  }
})</code></pre><p>One note when using signals is that the <strong>immediate</strong> option is gone. This keeps the api cleaner.</p><h2 id="actions">Actions</h2><p>Since cerebral 2.x is using <strong>function-tree</strong> under the hood we have other, more powerful options than before. The input, state is the same but output is gone. You can just return an object from the action that will be available in the input for the next action. You can also return a <strong>path</strong> that is a new concept in Cerebral 2.x and outdates output. <strong>path</strong> is used to determine the execution path for your chain. You do no longer have services as an argument in the context, use providers instead.</p><h3 id="1.x">1.x</h3><pre><code class="language-js">function myAction({input, state, output, services}) {

}</code></pre><p>In 2.x you have the following. Instead of services you hook up providers that supersedes services.</p><pre><code class="language-js">function myAction({input, state, path /*, myProvider, otherProvider */ }) {

}</code></pre><p>When you wanted to output to paths in 1.x you would do something like this</p><pre><code class="language-js">function myAction({state, output}) {
  if (state.get(&#x27;app.isAwesome&#x27;)) {
    output.awesome()
  } else {
    output.notSoAwesome()
  }
}
myAction.outputs = [&#x27;awesome&#x27;, &#x27;notSoAwesome&#x27;]</code></pre><p>With the new <strong>path</strong> concept this is simpler. In 2.x you would just do what is stated below. Please note the <strong>return path…</strong>. The same is true with promises. They need to be returned.</p><pre><code class="language-js">function myAction({state, path}) {
  if (state.get(&#x27;app.isAwesome&#x27;)) {
    return path.awesome()
  } else {
    return path.notSoAwesome()
  }
}</code></pre><p>If you don’t want to take another path in the execution tree you could return a new object that would be available in the input object.</p><pre><code class="language-js">function myAction({state, path}) {
  return {
    someData: &#x27;Some new data available at output.someData&#x27;
  }
}</code></pre><p>When doing async operations you would do something like this in 1.x</p><pre><code class="language-js">function myAction({output}) {
  setTimeout(() =&gt; {
    output({ /* optional output */ }) // or output.pathName({ /* optional output */ })
  }, 1000)
}

myAction.async = true</code></pre><p>In Cerebral 2 you you must resolve or reject a returned promise.</p><pre><code class="language-js">function myAction({path}) {
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      resolve({ /* optional output */ }) // or resolve(path.pathName({ /* optional output */ }))
    }, 1000)
  })
}</code></pre><p>In 1.x you could set a path that wasn’t defined yet in the state tree. Let’s say your state looked like this.</p><pre><code class="language-js">{
  app: {
    nodes: {}
  }
}</code></pre><p>You could do this in an action.</p><pre><code class="language-js">function myAction({state}) {
  state.set(&#x27;app.nodes.some.state.more&#x27;, {updated: true})
}</code></pre><p>With 2.x this is no longer possible. It’s easy to mistype paths and therefore this option is no longer available. Your paths need to be in place before setting values to them.</p><p>When using computed data in an action you could call <strong>state.computed(myComputed())</strong> in the action. This has changed in 2.x in favor of
<strong>state.compute(myComputed)</strong>. You can also pass props to the compute function.</p><pre><code class="language-js">function myAction({state}) {
  state.compute(someComputed)
  state.compute(someComputed.props({foo: &#x27;bar&#x27;}))
}</code></pre><p>This works the same in context for 2.x</p><pre><code class="language-js">connect({
  foo: someComputed,
  foo2: someComputed.props({foo: &#x27;bar&#x27;})
})</code></pre><h2 id="providers-(outdates-services)">Providers (outdates services)</h2><p>In 1.x you could add services that would be available to you in the actions. Typically, you would do something like this in 1.x</p><pre><code class="language-js">import someExternalApi from &#x27;some-external-api&#x27;

export default (options = {}) =&gt; module =&gt; {

  if (!options.apiKey) {
    throw new Error(&#x27;This service needs an apiKey&#x27;)
  }

  module.addServices({
    connect() {
      return someExternalApi.connect({
        apiKey: options.apiKey
      })
    }
  })

}</code></pre><p>In 2.x you would use providers instead.</p><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;
import ContextProvider from &#x27;cerebral/providers/context&#x27;
import axios from &#x27;axios&#x27;

const controller = Controller({
  providers: [
    ContextProvider({
      axios
    })
  ]
})</code></pre><p>or manually</p><pre><code class="language-js">import {Controller} from &#x27;cerebral&#x27;

const controller = Controller({
  provider(context) {
    context.myProvider = {
      doSomething() {}
    }
    return context
  }
})</code></pre><p>Now instead of having services in the context object in an action you would have the <strong>axios</strong> object.</p><pre><code class="language-js">function myAction({axios}) {

}</code></pre><h2 id="views">Views</h2><p>How you import view specific packages has changed. In 1.x you would import Container like this.</p><pre><code class="language-js">import controller from &#x27;./controller.js&#x27;
import React from &#x27;react&#x27;
import {render} from &#x27;react-dom&#x27;
import {Container} from &#x27;cerebral-view-react&#x27;

// Your main application component
import App from &#x27;./components/App&#x27;

render(
  &lt;Container controller={controller}&gt;
    &lt;App/&gt;
  &lt;/Container&gt;
, document.querySelector(&#x27;#app&#x27;))</code></pre><p>In 2.x you would not import the Container from another package.</p><pre><code class="language-js">import controller from &#x27;./controller.js&#x27;
import React from &#x27;react&#x27;
import {render} from &#x27;react-dom&#x27;
import {Container} from &#x27;cerebral/react&#x27;

// Your main application component
import App from &#x27;./components/App&#x27;

render(
  &lt;Container controller={controller}&gt;
    &lt;App/&gt;
  &lt;/Container&gt;
, document.querySelector(&#x27;#app&#x27;))</code></pre><p>The same is true when connecting Cerebral to your component. In 1.x you would import it like this.</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral-view-react&#x27;

export default connect({
  isLoading: &#x27;app.isLoading&#x27;
},
  function App(props) {
    return (
      &lt;div&gt;
        {props.isLoading ? &#x27;loading...&#x27; : null}
      &lt;/div&gt;
    )
  }
)</code></pre><p>In 2.x you would have to use a different import.</p><pre><code class="language-js">import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import {state} from &#x27;cerebral/tags&#x27;

export default connect({
  isLoading: state`app.isLoading`
},
  function App(props) {
    return (
      &lt;div&gt;
        {props.isLoading ? &#x27;loading...&#x27; : null}
      &lt;/div&gt;
    )
  }
)</code></pre><p>In 1.x you would first connect state, then signals as separate arguments in connect. In Cerebral 2.x these are combined, tags are used to differentiate between state, signals and props.</p><pre><code class="language-js">// 2.x
import React from &#x27;react&#x27;
import {connect} from &#x27;cerebral/react&#x27;
import {props, state, signal} from &#x27;cerebral/tags&#x27;

export default connect({
  isLoading: state`app.isLoading`,
  item: state`items.${props`itemId`}`,
  someSignal: signal`app.someSignal`
}.
  function App(props) {
    return (
      &lt;div&gt;
        {props.isLoading ? &#x27;loading...&#x27; : null}
      &lt;/div&gt;
    )
  }
)</code></pre><p>If you really want all signals in props as in 1.x you can set this as an option in the controller.</p><pre><code class="language-js">// 2.x
import {Controller} from &#x27;cerebral&#x27;
import ContextProvider from &#x27;cerebral/providers/context&#x27;
import axios from &#x27;axios&#x27;

const controller = Controller({
  options: {
     signalsProp: true
   }
})</code></pre><h2 id="model">Model</h2><p>The following functions have been removed from Cerebral 2.x when using state inside an action</p><ul><li>logModel</li><li>export</li><li>findWhere</li><li>keys</li><li>import</li><li>toJs</li><li>toJson</li></ul><h2 id="strict-render-mode">Strict render mode</h2><p>To setup strict render mode in 1.x for React was specified as follows.</p><pre><code class="language-js">render(
  &lt;Container controller={controller} strict&gt;
    &lt;App/&gt;
  &lt;/Container&gt;
, document.querySelector(&#x27;#app&#x27;))</code></pre><p>In 2.x this is the only mode</p><h2 id="devtools">Devtools</h2><p>The devtools has changed as well. Go to chrome store and install cerebral2 debugger. The setup has slightly changed from 1.x to 2.x as well as the import.</p><h3 id="1.x">1.x</h3><pre><code class="language-js">import Controller from &#x27;cerebral&#x27;
import Model from &#x27;cerebral/model/immutable&#x27;
import Devtools from &#x27;cerebral-module-devtools&#x27;

const controller = Controller(Model({}))

controller.addModules({
  devtools: process.env.NODE_ENV === &#x27;production&#x27; ? () =&gt; {} : Devtools()
})

export default controller</code></pre><h3 id="2.x">2.x</h3><pre><code class="language-js">import Controller from &#x27;cerebral&#x27;
import Devtools from &#x27;cerebral/devtools&#x27;

const controller = Controller({
  devtools: process.env.NODE_ENV === &#x27;production&#x27; ? () =&gt; {} : Devtools(),
  modules: {
    ...
  }
})

export default controller</code></pre></div></div></div><div class="docs-footer"><div class="docs-footer-column"><div class="docs-footer-header">ORGANIZATION</div><a class="docs-footer-link" href="https://github.com/cerebral/cerebral/graphs/contributors" target="_new">Contributors</a><a class="docs-footer-link" href="http://www.webpackbin.com" target="_new">www.webpackbin.com</a><a class="docs-footer-link" href="http://www.christianalfoni.com" target="_new">www.christianalfoni.com</a></div><div class="docs-footer-column"><div class="docs-footer-header">ARTICLES AND USEFUL LINKS</div><a class="docs-footer-link" href="http://medium.com/p/5793c08db2cc" target="_new">The story of Cerebral</a><a class="docs-footer-link" href="https://gist.github.com/christianalfoni/b08a99faa09df054afe87528a2134730" target="_new">An unlikely success story</a></div><div class="docs-footer-column"><div class="docs-footer-header">HELP</div><a class="docs-footer-link" href="https://github.com/cerebral/cerebral" target="_new">Cerebral github repo</a><a class="docs-footer-link" href="https://discord.gg/0kIweV4bd2bwwsvH" target="_new">Discoard chat</a></div></div></div></div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
<script src="/search.js"></script>
<script src="/scroll-detect.js"></script>
  </body>
</html>
