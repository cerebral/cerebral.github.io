<!DOCTYPE html>
<html>
  <head>
    <title>Cerebral Docs</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/images/favicons/manifest.json">
    <link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
<link rel="stylesheet" href="/main.css" />
<link rel="stylesheet" href="/prism.css" />
<link rel="stylesheet" href="/docs.css" />
  </head>
  <body>
    <div id="app"><div class="docs-container"><div class="beta">beta</div><div id="navigation" class="docs-navigation"><ul class="docs-navigation-menu"><li class="docs-navigation-item"><a href="/docs/introduction">introduction</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/api">api</a><div class="underline"></div></li><li class="docs-navigation-item active"><a href="/docs/addons">addons</a><div class="underline"></div></li><li class="docs-navigation-item"><a href="/docs/resources">resources</a><div class="underline"></div></li></ul><div class="docs-search"><input type="text" id="search-docs" placeholder="search..."/><div id="search-result" class="docs-search-result"></div></div><div class="docs-icons"><a href="https://github.com/cerebral/cerebral" class="docs-icon" target="_new"><div class="docs-icon-github"></div>github repo</a><a href="https://discord.gg/0kIweV4bd2bwwsvH" class="docs-icon" target="_new"><div class="docs-icon-discord"></div>chat</a><a href="http://cerebral-website.herokuapp.com/" class="docs-icon" target="_new" style="color:#DD4A68;">old website</a></div></div><div id="navigation-mobile" class="docs-navigation mobile"><div id="hamburger" class="docs-navigation-hamburger"></div><div class="docs-navigation-title mobile">addons</div><div class="docs-navigation-float mobile"><ul class="docs-navigation-menu mobile"><li class="docs-navigation-item mobile"><a href="/docs/introduction">introduction</a></li><li class="docs-navigation-item mobile"><a href="/docs/api">api</a></li><li class="docs-navigation-item active mobile"><a href="/docs/addons">addons</a><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="/docs/addons/index.html">@cerebral/router</a></li><li><a href="/docs/addons/http.html">@cerebral/http</a></li><li class="active"><a href="/docs/addons/firebase.html">@cerebral/firebase</a><ul><li><a href="#install">install</a></li><li><a href="#description">description</a></li><li><a href="#instantiate">instantiate</a></li><li><a href="#error">error</a><ul><li><a href="#firebaseprovidererror-(base)">FirebaseProviderError (base)</a></li><li><a href="#firebaseproviderauthenticationerror">FirebaseProviderAuthenticationError</a></li></ul></li><li><a href="#set">set</a></li><li><a href="#update">update</a></li><li><a href="#push">push</a></li><li><a href="#remove">remove</a></li><li><a href="#transaction">transaction</a></li><li><a href="#value">value</a></li><li><a href="#onvalue">onValue</a></li><li><a href="#onchildadded">onChildAdded</a></li><li><a href="#onchildremoved">onChildRemoved</a></li><li><a href="#onchildchanged">onChildChanged</a></li><li><a href="#off">off</a></li><li><a href="#task">task</a></li><li><a href="#getuser">getUser</a></li><li><a href="#signinanonymously">signInAnonymously</a></li><li><a href="#createuserwithemailandpassword">createUserWithEmailAndPassword</a></li><li><a href="#signinwithemailandpassword">signInWithEmailAndPassword</a></li><li><a href="#signinwith{provider}">signInWith{PROVIDER}</a></li><li><a href="#linkwithfacebook{provider}">linkWithFacebook{PROVIDER}</a></li><li><a href="#signout">signOut</a></li><li><a href="#sendpasswordresetemail">sendPasswordResetEmail</a></li><li><a href="#setondisconnect">setOnDisconnect</a></li><li><a href="#cancelondisconnect">cancelOnDisconnect</a></li><li><a href="#put">put</a></li><li><a href="#delete">delete</a></li></ul></li><li><a href="/docs/addons/useragent.html">@cerebral/useragent</a></li><li><a href="/docs/addons/forms.html">@cerebral/forms</a></li><li><a href="/docs/addons/storage.html">@cerebral/storage</a></li><li><a href="/docs/addons/firebase_admin.html">@cerebral/firebase-admin</a></li><li><a href="/docs/addons/function_tree.html">function-tree</a></li></ul></div></div></li><li class="docs-navigation-item mobile"><a href="/docs/resources">resources</a></li></ul></div></div><div class="docs-content"><div class="docs-toc"><div class="docs-toc-content"><div><strong>Table of contents</strong></div><ul><li><a href="/docs/addons/index.html">@cerebral/router</a></li><li><a href="/docs/addons/http.html">@cerebral/http</a></li><li class="active"><a href="/docs/addons/firebase.html">@cerebral/firebase</a><ul><li><a href="#install">install</a></li><li><a href="#description">description</a></li><li><a href="#instantiate">instantiate</a></li><li><a href="#error">error</a><ul><li><a href="#firebaseprovidererror-(base)">FirebaseProviderError (base)</a></li><li><a href="#firebaseproviderauthenticationerror">FirebaseProviderAuthenticationError</a></li></ul></li><li><a href="#set">set</a></li><li><a href="#update">update</a></li><li><a href="#push">push</a></li><li><a href="#remove">remove</a></li><li><a href="#transaction">transaction</a></li><li><a href="#value">value</a></li><li><a href="#onvalue">onValue</a></li><li><a href="#onchildadded">onChildAdded</a></li><li><a href="#onchildremoved">onChildRemoved</a></li><li><a href="#onchildchanged">onChildChanged</a></li><li><a href="#off">off</a></li><li><a href="#task">task</a></li><li><a href="#getuser">getUser</a></li><li><a href="#signinanonymously">signInAnonymously</a></li><li><a href="#createuserwithemailandpassword">createUserWithEmailAndPassword</a></li><li><a href="#signinwithemailandpassword">signInWithEmailAndPassword</a></li><li><a href="#signinwith{provider}">signInWith{PROVIDER}</a></li><li><a href="#linkwithfacebook{provider}">linkWithFacebook{PROVIDER}</a></li><li><a href="#signout">signOut</a></li><li><a href="#sendpasswordresetemail">sendPasswordResetEmail</a></li><li><a href="#setondisconnect">setOnDisconnect</a></li><li><a href="#cancelondisconnect">cancelOnDisconnect</a></li><li><a href="#put">put</a></li><li><a href="#delete">delete</a></li></ul></li><li><a href="/docs/addons/useragent.html">@cerebral/useragent</a></li><li><a href="/docs/addons/forms.html">@cerebral/forms</a></li><li><a href="/docs/addons/storage.html">@cerebral/storage</a></li><li><a href="/docs/addons/firebase_admin.html">@cerebral/firebase-admin</a></li><li><a href="/docs/addons/function_tree.html">function-tree</a></li></ul></div></div><div class="docs-doc"><div class="docs-doc-content"><div class="docs-doc-edit"><a href="https://github.com/cerebral/cerebral/tree/master/../../node_modules/@cerebral/firebase/README.md" target="_new">Edit on Github</a></div><h1>@cerebral/firebase</h1><h2>install</h2><p><strong>NPM</strong></p><p><code>npm install @cerebral/firebase --save</code></p><p><strong>YARN</strong></p><p><code>yarn add @cerebral/firebase</code></p><h2>description</h2><p>The Firebase provider is a Cerebral friendly wrapper around the Firebase client. By default the Firebase client is heavily event based, even just getting some value, handling authentication etc. This is useful in some types of apps, but Cerebral has a very straight forward way of thinking about side effects. You will find that a lot of the API exposed by the Firebase client is simplified!</p><h2>instantiate</h2><pre class="language-javascript"><code class="language-javascript">import {Controller} from &#x27;cerebral&#x27;
import FirebaseProvider from &#x27;@cerebral/firebase&#x27;

const controller = Controller({
  providers: [
    FirebaseProvider({
      config: {
        apiKey: &#x27;{apiKey}&#x27;,
        authDomain: &#x27;{authDomain}&#x27;,
        databaseURL: &#x27;{databaseURL}&#x27;,
        storageBucket: &#x27;{storageBucket}&#x27;
      },
      // When using tasks and firebase queue you can prefix
      // the specs triggered. This is useful in development
      // when multiple developers are working on the
      // same instance
      specPrefix: &#x27;CJ&#x27;
    })
  ]
})</code></pre><p><strong>Important notes</strong></p><ul><li><p>The Cerebral firebase provider uses <strong>dot</strong> notation to keep consistency with Cerebral itself</p></li><li><p>All factories supports template tags, allowing you to dynamically create paths and points to values</p></li></ul><h2>error</h2><h3>FirebaseProviderError (base)</h3><pre class="language-js"><code class="language-js">import {FirebaseProviderError} from &#x27;@cerebral/firebase&#x27;

// Error structure
{
  name: &#x27;HttpProviderError&#x27;,
  message: &#x27;Some firebase error message&#x27;
  stack: &#x27;...&#x27;  
}</code></pre><h3>FirebaseProviderAuthenticationError</h3><pre class="language-js"><code class="language-js">import {FirebaseProviderAuthenticationError} from &#x27;@cerebral/firebase&#x27;

// Error structure
{
  name: &#x27;HttpProviderError&#x27;,
  message: &#x27;Some firebase error message&#x27;
  code: 10 // firebase auth error code
  stack: &#x27;...&#x27;  
}</code></pre><h2>set</h2><p>Write data to this database location. This will overwrite any data at this location and all child locations. Passing <strong>null</strong> for the new value is equivalent to calling remove(); all data at this location or any child location will be deleted.</p><p><em>action</em></p><pre class="language-javascript"><code class="language-javascript">function someAction({firebase}) {
  return firebase.set(&#x27;foo.bar&#x27;, &#x27;baz&#x27;)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {props} from &#x27;cerebral/tags&#x27;
import {set} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  set(&#x27;foo.bar&#x27;, props`foo`),

  // Alternatively with explicit paths
  set(&#x27;foo.bar&#x27;, props`foo`), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p><h2>update</h2><p>As opposed to the set() method, update() can be use to selectively update only the referenced properties at the current location (instead of replacing all the child properties at the current location).</p><p><em>action</em></p><pre class="language-javascript"><code class="language-javascript">function someAction({firebase}) {
  return firebase.update(&#x27;some.path&#x27;, {
    &#x27;foo&#x27;: &#x27;bar&#x27;,
    &#x27;items.item1.isAwesome&#x27;: true
  })
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {props} from &#x27;cerebral/tags&#x27;
import {update} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  update(&#x27;some.path&#x27;, {
    &#x27;foo.bar&#x27;: props`bar`,
    &#x27;foo.baz&#x27;: props`baz`
  }),

  // Alternatively with explicit paths
  update(&#x27;some.path&#x27;, {
    &#x27;foo.bar&#x27;: props`bar`,
    &#x27;foo.baz&#x27;: props`baz`
  }), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p><h2>push</h2><p>Generates a new child location using a unique key and returns its reference from the action. An example being <code>{key: &quot;-KWKImT_t3SLmkJ4s3-w&quot;}</code>.</p><p><em>action</em></p><pre class="language-javascript"><code class="language-javascript">function someAction({firebase}) {
  return firebase.push(&#x27;users&#x27;, {
    name: &#x27;Bob&#x27;
  })
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {push} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  push(&#x27;users&#x27;, state`newUser`),

  // Alternatively with explicit paths
  push(&#x27;users&#x27;, state`newUser`), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{key: &#x27;theAddedKey&#x27;}</code></pre><h2>remove</h2><p>Remove the data at this database location.</p><p><em>action</em></p><pre class="language-javascript"><code class="language-javascript">function someAction({ firebase}) {
  return firebase.remove(&#x27;foo.bar&#x27;)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {props, string} from &#x27;cerebral/tags&#x27;
import {remove} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  remove(string`users.${props`userKey`}`),

  // Alternatively with explicit paths
  remove(string`users.${props`userKey`}`), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p><h2>transaction</h2><p>Atomically modifies the data at the provided location.</p><p>Unlike a normal set(), which just overwrites the data regardless of its previous value, transaction() is used to modify the existing value to a new value, ensuring there are no conflicts with other clients writing to the same location at the same time.</p><p>To accomplish this, you pass transaction() an update function which is used to transform the current value into a new value. If another client writes to the location before your new value is successfully written, your update function will be called again with the new current value, and the write will be retried. This will happen repeatedly until your write succeeds without conflict or you abort the transaction by not returning a value from your update function.</p><p><em>action</em></p><pre class="language-javascript"><code class="language-javascript">function someAction({firebase}) {

  function transactionFunction(currentData){
    if (currentData === null) {
      return { foo: &#x27;bar&#x27; }
    }

    return // Abort the transaction.
  }

  return firebase.transaction(&#x27;some.transaction.path&#x27;, transactionFunction)
    .then((result) =&gt; {
      if(result.committed){
        return {result: result.value}
      } else {
        throw new Error(&#x27;Transaction failed&#x27;)
      }
    })
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {transaction} from &#x27;@cerebral/firebase/operators&#x27;

function transactionFunction(currentData){
  if (currentData === null) {
    return { foo: &#x27;bar&#x27; }
  }

  return // Abort the transaction.
}

export default [
  transaction(&#x27;foo.bar&#x27;, transactionFunction),

  // Alternatively with explicit paths
  transaction(&#x27;foo.bar&#x27;, transactionFunction), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{committed: true, value: &#x27;new value&#x27;}</code></pre><p>Note: Modifying data with set() will cancel any pending transactions at that location, so extreme care should be taken if mixing set() and transaction() to update the same data.</p><p>Note: When using transactions with Security and Firebase Rules in place, be aware that a client needs .read access in addition to .write access in order to perform a transaction. This is because the client-side nature of transactions requires the client to read the data in order to transactionally update it.</p><h2>value</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  return firebase.value(&#x27;someKey.foo&#x27;)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {value} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  value(&#x27;foo.bar&#x27;),

  // Alternatively with explicit paths
  value(&#x27;foo.bar&#x27;), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{key: &#x27;keyYouLookedUpValueOn&#x27;, value: &#x27;the value&#x27;}</code></pre><h2>onValue</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.onValue(&#x27;someKey.foo&#x27;, &#x27;someModule.fooUpdated&#x27;,  {
    payload: {}, // Merged with the payload passed on new data
  });
}</code></pre><p>This will <strong>NOT</strong> immediately grab the value and trigger the signal passed, the first event is discarded for more predictable behaviour. To grab existing value, just use <code>value</code>.</p><p>To stop listening for updates to the value:</p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.off(&#x27;someKey.foo&#x27;, &#x27;onValue&#x27;);
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {onValue} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  onValue(&#x27;foo.bar&#x27;, &#x27;some.signal&#x27;)
]</code></pre><h2>onChildAdded</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.onChildAdded(&#x27;posts&#x27;, &#x27;posts.postAdded&#x27;, {
    payload: {}, // Merged with the payload passed on new data
    limitToFirst: 5, // Read Firebase docs
    limitToLast: 5, // Read Firebase docs
    startAt: 5, // Read Firebase docs
    endAt: 5, // Read Firebase docs
    equalTo: 5, // Read Firebase docs
    orderByChild: &#x27;count&#x27;, // Read Firebase docs
    orderByKey: true, // Read Firebase docs
    orderByValue: true // Read Firebase docs
  });
}</code></pre><p>This will immediately grab and trigger the signal <code>posts.postAdded</code> for every post grabbed. Note this is just registering a listener, not returning a value from the action. The signal is triggered with the payload: <code>{ key: &#x27;someKey&#x27;, value: {} }</code>.</p><p>To stop listening for updates to the posts:</p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.off(&#x27;posts&#x27;, &#x27;onChildAdded&#x27;);
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {onChildAdded} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  onChildAdded(&#x27;foo.bar&#x27;, &#x27;some.signal&#x27;, {
    orderByChild: &#x27;count&#x27;,
    limitToFirst: state`config.limitToFirst`
  })
]</code></pre><h2>onChildRemoved</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.onChildRemoved(&#x27;posts&#x27;, &#x27;posts.postRemoved&#x27;, {
    // Same options as above
  });
}</code></pre><p>This will trigger the signal <code>posts.postRemoved</code> whenever a post is removed from the selection. The signal is triggered with the payload: <code>{ key: &#x27;someKey&#x27; }</code>.</p><p>To stop listening:</p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.off(&#x27;posts&#x27;, &#x27;onChildRemoved&#x27;);
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {onChildRemoved} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  onChildRemoved(&#x27;foo.bar&#x27;, &#x27;some.signal&#x27;, {
    // Same options as above
  })
]</code></pre><h2>onChildChanged</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.onChildChanged(&#x27;posts&#x27;, &#x27;posts.postChanged&#x27;, {
    // Same options as above
  });
}</code></pre><p>This will trigger the signal <code>posts.postChanged</code> whenever a post is changed in the selection. The signal is triggered with the payload: <code>{ key: &#x27;someKey&#x27;, value: {} }</code>.</p><p>To stop listening:</p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  firebase.off(&#x27;posts&#x27;, &#x27;onChildChanged&#x27;);
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {onChildChanged} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  onChildChanged(&#x27;foo.bar&#x27;, &#x27;some.signal&#x27;, {
    // Same options as above
  })
]</code></pre><h2>off</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  // Turn off listener at specific path and
  // specific event
  firebase.off(&#x27;posts&#x27;, &#x27;onChildChanged&#x27;)

  // Turn off all listeners at specific path
  firebase.off(&#x27;posts&#x27;, &#x27;onChildChanged&#x27;)

  // Turn off all listeners of specific event at wildcard path
  firebase.off(&#x27;posts.*&#x27;, &#x27;onChildChanged&#x27;)

  // Turn off all listeners at wildcard path
  firebase.off(&#x27;posts.*&#x27;)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {string} from &#x27;cerebral/tags&#x27;
import {off} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  // Same API as in actions, also wildcard
  off(&#x27;posts&#x27;, &#x27;onChildChanged&#x27;),

  // Compose using string tag
  off(string`posts.${state`selectedPostKey`}`)
]</code></pre><h2>task</h2><p>If you are using the <a href="https://github.com/firebase/firebase-queue" target="new">firebase-queue</a> and need to create tasks, you can do that with:</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  return firebase.task(&#x27;create_post&#x27;, {
    uid: state.get(&#x27;app.user.uid&#x27;),
    text: state.get(&#x27;posts.newPostText&#x27;)
  })
}</code></pre><p>This will add a task at <code>queue/tasks</code>. There is no output from a resolved task, it just resolves when the action has been processed.</p><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state, props} from &#x27;cerebral/tags&#x27;
import {task} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  task(&#x27;some_task&#x27;, {
    uid: state`user.uid`,
    data: props`data`
  }),

  // Alternatively with explicit paths
  task(&#x27;some_task&#x27;, {
    uid: state`user.uid`,
    data: props`data`
  }), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p><h2>getUser</h2><p>Will resolve to <code>{user: {}}</code> if user exists. If user was redirected from Facebook/Google etc. as part of first sign in, this method will handle the confirmed registration of the user.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  return firebase.getUser()
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {getUser} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  getUser(),

  // Alternatively with explicit paths
  getUser(), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{user: {}}</code></pre><h2>signInAnonymously</h2><p>This login will method will resolve to existing anonymous or create a new one for you.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  return firebase.signInAnonymously()
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {signInAnonymously} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  signInAnonymously(),

  // Alternatively with explicit paths
  signInAnonymously(), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{user: {}}</code></pre><h2>createUserWithEmailAndPassword</h2><p>Register a new user with email and password.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  const email = state.get(&#x27;register.email&#x27;)
  const password = state.get(&#x27;register.password&#x27;)

  return firebase.createUserWithEmailAndPassword(email, password)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {createUserWithEmailAndPassword} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  createUserWithEmailAndPassword(state`newUser.email`, state`newUser.password`),

  // Alternatively with explicit paths
  createUserWithEmailAndPassword(state`newUser.email`, state`newUser.password`), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{user: {}}</code></pre><h2>signInWithEmailAndPassword</h2><p>Sign in a user with email and password.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, path, state }) {
  const email = state.get(&#x27;register.email&#x27;)
  const password = state.get(&#x27;register.password&#x27;)

  return firebase.signInWithEmailAndPassword(email, password)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {props} from &#x27;cerebral/tags&#x27;
import {signInWithEmailAndPassword} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  signInWithEmailAndPassword(props`email`, props`password`),

  // Alternatively with explicit paths
  signInWithEmailAndPassword(props`email`, props`password`), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-javascript"><code class="language-javascript">{user: {}}</code></pre><h2>signInWith{PROVIDER}</h2><p>Sign in a user with Facebook, Google or Github.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  return firebase.signInWithFacebook({
    redirect: false, // Use popup or redirect. Redirect typically for mobile
    scopes: [] // Facebook scopes to access
  })
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {signInWithFacebook} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  signInWithFacebook({
    redirect: state`useragent.media.small`
  }),

  // Alternatively with explicit paths
  signInWithFacebook({
    redirect: state`useragent.media.small`
  }), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
Either this will be a redirect or it outputs:</p><pre class="language-javascript"><code class="language-javascript">{user: {}}</code></pre><p>Similar you can sign in with Google or GitHub.
Just use <code>signInWithGoogle</code> or <code>signInWithGithub</code> instead of <code>signInWithFacebook</code>.</p><h2>linkWithFacebook{PROVIDER}</h2><p>Link an anonymous account with Facebook, Google or Github.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  return firebase.linkWithFacebook({
    redirect: false, // Use popup or redirect. Redirect typically for mobile
    scopes: [] // Facebook scopes to access
  })
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {linkWithFacebook} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  linkWithFacebook({
    redirect: state`useragent.media.small`
  }),

  // Alternatively with explicit paths
  linkWithFacebook({
    redirect: state`useragent.media.small`
  }), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
Either this will be a redirect or it outputs:</p><pre class="language-javascript"><code class="language-javascript">{user: {}}</code></pre><p>Similar you can sign in with Google or GitHub.
Just use <code>linkWithGoogle</code> or <code>linkWithGithub</code> instead of <code>linkWithFacebook</code>.</p><h2>signOut</h2><p>Sign out user. <strong>getUser</strong> will now not resolve a user anymore.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase }) {
  return firebase.signOut()
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {signOut} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  signOut(),

  // Alternatively with explicit paths
  signOut(), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p><h2>sendPasswordResetEmail</h2><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  return firebase.sendPasswordResetEmail(state.get(&#x27;user.email&#x27;))
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {sendPasswordResetEmail} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  sendPasswordResetEmail(state`user.email`),

  // Alternatively with explicit paths
  sendPasswordResetEmail(state`user.email`), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p><h2>setOnDisconnect</h2><p>Sets a value when Firebase detects user has disconnected.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  firebase.setOnDisconnect(`activeUsers.${state.get(&#x27;app.user.uid&#x27;)}`, &#x27;someValue&#x27;)
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {setOnDisconnect} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  setOnDisconnect(string`activeUsers.${state`app.user.uid`}`, null)
]</code></pre><p><em>output</em>
No output</p><h2>cancelOnDisconnect</h2><p>Cancel setting a value when Firebase detects disconnect.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, state }) {
  firebase.cancelOnDisconnect()
}</code></pre><p><em>factory</em></p><pre class="language-javascript"><code class="language-javascript">import {state} from &#x27;cerebral/tags&#x27;
import {cancelOnDisconnect} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  cancelOnDisconnect()
]</code></pre><p><em>output</em>
No output</p><h2>put</h2><p>Upload a new file at the given location. Please note that the file is <strong>not</strong> stored inside the realtime database but into Google Cloud Storage (please consult filrebase documentation). This means that you need to take care of storage security as well.</p><p>Note that <code>put</code> expects a folder as first argument and will use the name of the provided file. If you want to control the filename, add this in the options. In this case, make sure to respect file type and extension…</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, props }) {
  return firebase.put(&#x27;folderName&#x27;, props.file, {
    progress({progress, bytesTransferred, totalBytes, state}) {
      /* do whatever */
    },
    // Override name, make sure you set same extension
    filename: &#x27;customName.png&#x27;
  })
}</code></pre><p><em>factory</em></p><pre class="language-js"><code class="language-js">import {props, signal, string, state} from &#x27;cerebral/tags&#x27;
import {put} from &#x27;@cerebral/firebase/operators&#x27;

// we expect props.file to contain a file provided by
// a user in an &lt;input type=&#x27;file&#x27; /&gt;
export default [
  put(string`posts.all.${props`postId`}`, props`file`, {
    // Trigger a signal which receives payload
    progress: signal`gallery.progress`
    // Set progress on a state value
    progress: state`gallery.progress`
  }),

  // Alternatively with explicit paths
  put(string`posts.all.${props`postId`}`, props`file`, {
    progress: signal`gallery.progress`
    progress: state`gallery.progress`
  }), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em></p><pre class="language-js"><code class="language-js">{url: &#x27;urlToFile&#x27;, filename: &#x27;nameOfFile&#x27;}</code></pre><h2>delete</h2><p>Use <code>delete</code> to remove an uploaded file. Specify the containing folder and filename.</p><p><em>action</em></p><pre class="language-js"><code class="language-js">function someAction({ firebase, props }) {
  return firebase.delete(&#x27;folderName&#x27;, props.fileName)
}</code></pre><p><em>factory</em></p><pre class="language-js"><code class="language-js">import {props, state, string} from &#x27;cerebral/tags&#x27;
import {delete as firebaseDelete} from &#x27;@cerebral/firebase/operators&#x27;

export default [
  firebaseDelete(
    string`posts.all.${props`postId`}`,
    state`posts.all.${props`postId`}.imageName`
  ),

  // Alternatively with explicit paths
  firebaseDelete(
    string`posts.all.${props`postId`}`,
    state`posts.all.${props`postId`}.imageName`
  ), {
    success: [],
    error: []
  }
]</code></pre><p><em>output</em>
No output</p></div></div></div></div></div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
<script src="/search.js"></script>
<script src="/mobile.js"></script>
  </body>
</html>
