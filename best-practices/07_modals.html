<!DOCTYPE html><html class="ua_js_no" lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Cerebral</title><script>(function(e,c){e[c]=e[c].replace(/(ua_js_)no/g,"$1yes");})(document.documentElement,"className");</script><link rel="stylesheet" href="../css/styles.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:700,500,400"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"/><link rel="shortcut icon" href="../favicon.ico"/><meta name="viewport" content="width=device-width,maximum-scale=1,initial-scale=1,user-scalable=no"/><meta name="format-detection" content="telephone=no"/><link name="apple-mobile-web-app-capable" content="yes"/></head><body class="page page_layout_best-practices"><div class="page__header"><div class="head-nav"><a class="link link__control head-nav__home i-bem" data-bem='{"link":{}}' role="link" href="../"></a></div></div><div class="page__content"><div class="wip">This documentation is about upcoming cerebral v2 which is currently is work in progress.<br/>Documentation might not always describe actual state of API.<br/>API itself could have some notable changes, though it shouldn't be critical.<br/>Feel free to contribute to docs by clicking Edit on Github link.</div><div class="row"><div class="row__col row__col_sw_24 row__col_lw_5 row__col_sol row__col_mol"><div class="side-nav"><div class="menu menu_theme_islands menu_size_xl menu_mode_radio-check menu__control i-bem" data-bem='{"menu":{}}' role="menu" tabindex="0"><div class="menu__group" role="group" aria-labelledby="uniq1484062524527826"><div class="menu__group-title" role="presentation" id="uniq1484062524527826">Install</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/01_cerebral"}}' role="menuitemradio" id="uniq1484062524527827" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/01_cerebral.html">Cerebral</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/02_debugger"}}' role="menuitemradio" id="uniq1484062524527828" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/02_debugger.html">Debugger</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/03_boilerplate"}}' role="menuitemradio" id="uniq1484062524527829" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/03_boilerplate.html">Boilerplate</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/04_tools"}}' role="menuitemradio" id="uniq1484062524527830" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/04_tools.html">Tools</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/05_function-tree"}}' role="menuitemradio" id="uniq1484062524527831" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/05_function-tree.html">Function Tree</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1484062524527832"><div class="menu__group-title" role="presentation" id="uniq1484062524527832">Tutorial</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/01_introduction"}}' role="menuitemradio" id="uniq1484062524527833" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/01_introduction.html">Introduction</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/02_define-state"}}' role="menuitemradio" id="uniq1484062524527834" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/02_define-state.html">ch01. Define State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/03_render-state"}}' role="menuitemradio" id="uniq1484062524527835" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/03_render-state.html">ch02. Render state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/04_update-state"}}' role="menuitemradio" id="uniq1484062524527836" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/04_update-state.html">ch03. Update state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/05_using-chains"}}' role="menuitemradio" id="uniq1484062524527837" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/05_using-chains.html">ch04. Chains</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/06_using-inputoutput"}}' role="menuitemradio" id="uniq1484062524527838" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/06_using-inputoutput.html">ch05. Actions</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/07_using-async-actions"}}' role="menuitemradio" id="uniq1484062524527839" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/07_using-async-actions.html">ch06. Async actions</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/08_using-paths"}}' role="menuitemradio" id="uniq1484062524527840" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/08_using-paths.html">ch07. Paths</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/09_compute_state"}}' role="menuitemradio" id="uniq1484062524527841" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/09_compute_state.html">ch08. Compute state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/10_providers"}}' role="menuitemradio" id="uniq1484062524527842" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/10_providers.html">ch09. Providers</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/11_routing"}}' role="menuitemradio" id="uniq1484062524527843" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/11_routing.html">ch10. Routing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/12_refactoring_modules"}}' role="menuitemradio" id="uniq1484062524527844" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/12_refactoring_modules.html">ch11. Modules</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1484062524527845"><div class="menu__group-title" role="presentation" id="uniq1484062524527845">In depth</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/01_the-architecture"}}' role="menuitemradio" id="uniq1484062524527846" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/01_the-architecture.html">The architecture</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/02_controller"}}' role="menuitemradio" id="uniq1484062524527847" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/02_controller.html">Controller</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/03_state"}}' role="menuitemradio" id="uniq1484062524527848" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/03_state.html">State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/04_signals"}}' role="menuitemradio" id="uniq1484062524527849" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/04_signals.html">Signals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/05_chains-and-paths"}}' role="menuitemradio" id="uniq1484062524527850" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/05_chains-and-paths.html">Chains and paths</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/06_actions"}}' role="menuitemradio" id="uniq1484062524527851" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/06_actions.html">Actions</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/07_providers"}}' role="menuitemradio" id="uniq1484062524527852" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/07_providers.html">Providers</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/08_operators"}}' role="menuitemradio" id="uniq1484062524527853" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/08_operators.html">Operators</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/09_factories"}}' role="menuitemradio" id="uniq1484062524527854" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/09_factories.html">Factories</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/10_connect"}}' role="menuitemradio" id="uniq1484062524527855" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/10_connect.html">Connect</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/11_computed"}}' role="menuitemradio" id="uniq1484062524527856" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/11_computed.html">Computed</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/12_routing"}}' role="menuitemradio" id="uniq1484062524527857" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/12_routing.html">Routing</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1484062524527858"><div class="menu__group-title" role="presentation" id="uniq1484062524527858">Best practices</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/01_organizing"}}' role="menuitemradio" id="uniq1484062524527859" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/01_organizing.html">Organizing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/02_constants"}}' role="menuitemradio" id="uniq1484062524527860" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/02_constants.html">Constants</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/03_testing"}}' role="menuitemradio" id="uniq1484062524527861" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/03_testing.html">Testing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/04_load-initial-data"}}' role="menuitemradio" id="uniq1484062524527862" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/04_load-initial-data.html">Load initial data</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/05_storing-server-data"}}' role="menuitemradio" id="uniq1484062524527863" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/05_storing-server-data.html">Storing server data</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/06_lists"}}' role="menuitemradio" id="uniq1484062524527864" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/06_lists.html">Lists</a></div><div class="menu-item menu-item_type_link menu-item_checked menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/07_modals"}}' role="menuitemradio" id="uniq1484062524527865" aria-checked="true"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/07_modals.html">Modals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/08_feedback-message"}}' role="menuitemradio" id="uniq1484062524527866" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/08_feedback-message.html">Feedback messages</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/09_popups"}}' role="menuitemradio" id="uniq1484062524527867" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/09_popups.html">Popups</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/10_long-running-side-effects"}}' role="menuitemradio" id="uniq1484062524527868" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/10_long-running-side-effects.html">Long running side effects</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/11_server-side"}}' role="menuitemradio" id="uniq1484062524527869" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/11_server-side.html">Server side</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1484062524527870"><div class="menu__group-title" role="presentation" id="uniq1484062524527870">Migration</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"migration/01_start_migration"}}' role="menuitemradio" id="uniq1484062524527871" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../migration/01_start_migration.html">From 1.x to 2.x</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1484062524527872"><div class="menu__group-title" role="presentation" id="uniq1484062524527872">API</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/01_controller"}}' role="menuitemradio" id="uniq1484062524527873" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/01_controller.html">Controller</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/02_state"}}' role="menuitemradio" id="uniq1484062524527874" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/02_state.html">State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/03_signals"}}' role="menuitemradio" id="uniq1484062524527875" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/03_signals.html">Signals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/04_connect"}}' role="menuitemradio" id="uniq1484062524527876" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/04_connect.html">Connect</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/05_modules"}}' role="menuitemradio" id="uniq1484062524527877" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/05_modules.html">Modules</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/06_operators"}}' role="menuitemradio" id="uniq1484062524527878" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/06_operators.html">Operators</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/07_providers"}}' role="menuitemradio" id="uniq1484062524527879" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/07_providers.html">Providers</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/08_router"}}' role="menuitemradio" id="uniq1484062524527880" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/08_router.html">Router</a></div></div></div></div></div><div class="row__col row__col_sw_24 row__col_lw_18 row__col_lo_1"><div class="page__edit"><a class="link link_theme_islands link__control i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral/tree/master/packages/docs/content/best-practices/07_modals.en.md">Edit on GitHub</a></div><h2 class="heading heading_lvl_2" id="modals">Modals</h2>
<p class="paragraph">Modals are one of those things that are more complex than you might think. So lets start with a simple modal using a module:</p>
<p class="paragraph"><em>src/modules/app/index.js</em></p>
<pre><code class="code" class="lang-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'My modal demo'</span><span class="token punctuation">,</span>
    showMyModal<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">Either we want to show the modal or we do not. To actually trigger the modal we can create a signal that will toggle the state. To simplify the example we define the chain inside the same file:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> toggle<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'My modal demo'</span><span class="token punctuation">,</span>
    showMyModal<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  signals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    myModalToggled<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token function">toggle</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showMyModal`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">So in our view we just render the Modal:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">import</span> MyModal <span class="token keyword">from</span> <span class="token string">'./MyModal'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'app.title'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  myModalToggled<span class="token punctuation">:</span> <span class="token string">'app.myModalToggled'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> props<span class="token punctuation">.</span><span class="token function">myModalToggled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
        <span class="token operator">&lt;</span>MyModal <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">So what to take note of here is that we have created a specific modal component for our modal. That means if we want multiple modals in our application each of them will have their own <code class="code">modal</code> state and component. That does not mean you have to create the backdrop and modal container for each modal, that is just UI, but you create a specific component for each modal and connect what state it wants directly. Lets look at the modal we just created using React as an example:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">import</span> ModalContainer <span class="token keyword">from</span> <span class="token string">'./ModalContainer'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  show<span class="token punctuation">:</span> <span class="token string">'app.showMyModal'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  myModalToggled<span class="token punctuation">:</span> <span class="token string">'app.myModalToggled'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">MyModal</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>props<span class="token punctuation">.</span>show<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>ModalContainer onClose<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>myModalToggled<span class="token punctuation">}</span><span class="token operator">></span>
        Hello modal<span class="token operator">!</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ModalContainer<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">We control the modal from within the component. Either it does not show anything or it will render a <strong>fixed</strong> modal container which allows us to pass in a signal to run when the modal should close.</p>
<h3 class="heading heading_lvl_3" id="increasing-complexity">Increasing complexity</h3>
<p class="paragraph">So let us increase complexity here. What if our modal was a modal to show a user based on a userId? An approach to this is adding a <strong>currentUserId</strong> to state. And instead of having a <strong>modalToggled</strong> kind of signal we have one signal for opening the modal, where we set the passed in <em>userId</em>, and an other for closing it:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'My modal demo'</span><span class="token punctuation">,</span>
    showUserModal<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    currentUserKey<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    users<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  signals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    userModalOpened<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showUserModal`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.currentUserKey`</span></span><span class="token punctuation">,</span> input<span class="token template-string"><span class="token string">`userKey`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    userModalClosed<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showUserModal`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">Since we dynamically want to load our user into the modal, we pass it in from the component responsible for showing the modal:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">import</span> UserModal <span class="token keyword">from</span> <span class="token string">'../UserModal'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'app.title'</span><span class="token punctuation">,</span>
  currentUserKey<span class="token punctuation">:</span> <span class="token string">'app.currentUserKey'</span><span class="token punctuation">,</span>
  users<span class="token punctuation">:</span> <span class="token string">'app.users'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  userModalOpened<span class="token punctuation">:</span> <span class="token string">'app.userModalOpened'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>UserModal currentUserKey<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>currentUserKey<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>ul<span class="token operator">></span>
          <span class="token punctuation">{</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>users<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>userKey<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>userKey<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> props<span class="token punctuation">.</span><span class="token function">userModalOpened</span><span class="token punctuation">(</span><span class="token punctuation">{</span>userKey<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
              props<span class="token punctuation">.</span>users<span class="token punctuation">[</span>userKey<span class="token punctuation">]</span><span class="token punctuation">.</span>name
            <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">Now our modal component can grab the user and update separately from the list:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">import</span> ModalContainer <span class="token keyword">from</span> <span class="token string">'./ModalContainer'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  show<span class="token punctuation">:</span> <span class="token string">'app.showMyModal'</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`app.users.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>currentUserKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  userModalClosed<span class="token punctuation">:</span> <span class="token string">'app.userModalClosed'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">UserModal</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>props<span class="token punctuation">.</span>show<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>ModalContainer onClose<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>userModalClosed<span class="token punctuation">}</span><span class="token operator">></span>
        Hello <span class="token punctuation">{</span>props<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">!</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ModalContainer<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">What is good about this approach is that you can very easily handle grabbing more information about the user if needed. Lets say we needed to download the user projects when opening the modal:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> input<span class="token punctuation">,</span> string<span class="token punctuation">,</span> when<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>httpGet<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral-provider-http'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'My modal demo'</span><span class="token punctuation">,</span>
    showUserModal<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    currentUserKey<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    users<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    isLoadingProjects<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  signals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    userModalOpened<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showUserModal`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.currentUserKey`</span></span><span class="token punctuation">,</span> input<span class="token template-string"><span class="token string">`userKey`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.isLoadingProjects`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>input<span class="token template-string"><span class="token string">`userId`</span></span><span class="token punctuation">,</span> state<span class="token template-string"><span class="token string">`app.users.${input`</span></span>userKey<span class="token template-string"><span class="token string">`}.id`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">httpGet</span><span class="token punctuation">(</span>string<span class="token template-string"><span class="token string">`/users/${input`</span></span>userId<span class="token template-string"><span class="token string">`}/projects`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        success<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.users.${input`</span></span>userKey<span class="token template-string"><span class="token string">`}.projects`</span></span><span class="token punctuation">,</span> input<span class="token template-string"><span class="token string">`result`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        error<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.isLoadingProjects`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    userModalClosed<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showUserModal`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">This is not Cerebral complexity, this is application complexity and it has to be defined somewhere. We could hide it in an abstraction or we can describe it exactly as it happens so everybody understands, including the debugger!</p>
<h3 class="heading heading_lvl_3" id="editing-the-user">Editing the user</h3>
<p class="paragraph">So what if we display the user to edit it? Well, we have to take into account that we probably do not want to edit the user directly, we rather want a copy of the data that will later be merged in with the user if we submit it. So instead of pointing to the user, we will copy over the details of the user for edit in our modal. When the modal close, we update the server:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> input<span class="token punctuation">,</span> string<span class="token punctuation">,</span> when<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>httpPatch<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral-provider-http'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'My modal demo'</span><span class="token punctuation">,</span>
    userModal<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      show<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      fields<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        firstName<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        lastName<span class="token punctuation">:</span> <span class="token string">''</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    users<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    isSavingUser<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  signals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    userModalOpened<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.userModal.show`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.userModal.fields.firstName`</span></span><span class="token punctuation">,</span> state<span class="token template-string"><span class="token string">`users.${input`</span></span>userKey<span class="token template-string"><span class="token string">`}.firstName`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.userModal.fields.lastName`</span></span><span class="token punctuation">,</span> state<span class="token template-string"><span class="token string">`users.${input`</span></span>userKey<span class="token template-string"><span class="token string">`}.lastName`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    userModalClosed<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>input<span class="token template-string"><span class="token string">`userId`</span></span><span class="token punctuation">,</span> state<span class="token template-string"><span class="token string">`app.users.${input`</span></span>userKey<span class="token template-string"><span class="token string">`}.id`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`isSavingUser`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">httpPatch</span><span class="token punctuation">(</span>string<span class="token template-string"><span class="token string">`/users/${input`</span></span>userId<span class="token template-string"><span class="token string">`}`</span></span><span class="token punctuation">,</span> state<span class="token template-string"><span class="token string">`userModal.fields`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        success<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`isSavingUser`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.userModal.show`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        error<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">We brought a lot of complexity into this, but that is important as typically this is what you want to do in applications. Modals can also be handled other ways, for example maybe you want an array of named modals which is mounted by a &quot;modal controller component&quot;. This pretty much works like you would handle pages with the router, though you rather render multiple modals on top of each other. The important thing here is to see that everything is the same. It does not matter the complexity and customization you want to do, you are completely free to do it however you want.</p>
</div></div></div><footer class="footer page__footer"><div class="row"><div class="row__col row__col_sw_24 row__col_lw_6"><h4 class="footer__header">ORGANIZATION</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral/graphs/contributors">Contributors</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="http://www.webpackbin.com">www.webpackbin.com</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="http://www.christianalfoni.com">www.christianalfoni.com</a></div><div class="row__col row__col_sw_24 row__col_lw_6 row__col_lo_3"><h4 class="footer__header">ARTICLES AND USEFUL LINKS</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="http://medium.com/p/5793c08db2cc">The story of Cerebral</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://gist.github.com/christianalfoni/b08a99faa09df054afe87528a2134730">An unlikely success story</a></div><div class="row__col row__col_sw_24 row__col_lw_6 row__col_lo_6"><h4 class="footer__header">HELP</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral">Cerebral github repo</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://discord.gg/0kIweV4bd2bwwsvH">Discord chat</a></div></div></footer><script src="../js/scripts.min.js"></script></body></html>