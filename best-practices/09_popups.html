<!DOCTYPE html><html class="ua_js_no" lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Cerebral</title><script>(function(e,c){e[c]=e[c].replace(/(ua_js_)no/g,"$1yes");})(document.documentElement,"className");</script><link rel="stylesheet" href="../css/styles.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:700,500,400"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"/><link rel="shortcut icon" href="../favicon.ico"/><meta name="viewport" content="width=device-width,maximum-scale=1,initial-scale=1,user-scalable=no"/><meta name="format-detection" content="telephone=no"/><link name="apple-mobile-web-app-capable" content="yes"/></head><body class="page page_layout_best-practices"><div class="page__header"><div class="head-nav"><a class="link link__control head-nav__home i-bem" data-bem='{"link":{}}' role="link" href="../"></a></div></div><div class="page__content"><div class="wip">This documentation is about upcoming cerebral v2 which is currently is work in progress.<br/>Documentation might not always describe actual state of API.<br/>API itself could have some notable changes, though it shouldn't be critical.<br/>Feel free to contribute to docs by clicking Edit on Github link.</div><div class="row"><div class="row__col row__col_sw_24 row__col_lw_5 row__col_sol row__col_mol"><div class="side-nav"><div class="menu menu_theme_islands menu_size_xl menu_mode_radio-check menu__control i-bem" data-bem='{"menu":{}}' role="menu" tabindex="0"><div class="menu__group" role="group" aria-labelledby="uniq1482182099817936"><div class="menu__group-title" role="presentation" id="uniq1482182099817936">Install</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/01_cerebral"}}' role="menuitemradio" id="uniq1482182099817937" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/01_cerebral.html">Cerebral</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/02_debugger"}}' role="menuitemradio" id="uniq1482182099817938" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/02_debugger.html">Debugger</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/03_boilerplate"}}' role="menuitemradio" id="uniq1482182099817939" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/03_boilerplate.html">Boilerplate</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/04_tools"}}' role="menuitemradio" id="uniq1482182099817940" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/04_tools.html">Tools</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"install/05_function-tree"}}' role="menuitemradio" id="uniq1482182099817941" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../install/05_function-tree.html">Function Tree</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1482182099817942"><div class="menu__group-title" role="presentation" id="uniq1482182099817942">Tutorial</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/01_introduction"}}' role="menuitemradio" id="uniq1482182099817943" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/01_introduction.html">Introduction</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/02_define-state"}}' role="menuitemradio" id="uniq1482182099817944" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/02_define-state.html">ch01. Define State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/03_render-state"}}' role="menuitemradio" id="uniq1482182099817945" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/03_render-state.html">ch02. Render state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/04_update-state"}}' role="menuitemradio" id="uniq1482182099817946" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/04_update-state.html">ch03. Update state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/05_using-chains"}}' role="menuitemradio" id="uniq1482182099817947" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/05_using-chains.html">ch04. Chains</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/06_using-inputoutput"}}' role="menuitemradio" id="uniq1482182099817948" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/06_using-inputoutput.html">ch05. Actions</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/07_using-async-actions"}}' role="menuitemradio" id="uniq1482182099817949" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/07_using-async-actions.html">ch06. Async actions</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/08_using-paths"}}' role="menuitemradio" id="uniq1482182099817950" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/08_using-paths.html">ch07. Paths</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/09_compute_state"}}' role="menuitemradio" id="uniq1482182099817951" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/09_compute_state.html">ch08. Compute state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/10_providers"}}' role="menuitemradio" id="uniq1482182099817952" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/10_providers.html">ch09. Providers</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/11_routing"}}' role="menuitemradio" id="uniq1482182099817953" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/11_routing.html">ch10. Routing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"tutorial/12_refactoring_modules"}}' role="menuitemradio" id="uniq1482182099817954" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../tutorial/12_refactoring_modules.html">ch11. Modules</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1482182099817955"><div class="menu__group-title" role="presentation" id="uniq1482182099817955">In depth</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/01_the-architecture"}}' role="menuitemradio" id="uniq1482182099817956" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/01_the-architecture.html">The architecture</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/02_controller"}}' role="menuitemradio" id="uniq1482182099817957" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/02_controller.html">Controller</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/03_state"}}' role="menuitemradio" id="uniq1482182099817958" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/03_state.html">State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/04_signals"}}' role="menuitemradio" id="uniq1482182099817959" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/04_signals.html">Signals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/05_chains-and-paths"}}' role="menuitemradio" id="uniq1482182099817960" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/05_chains-and-paths.html">Chains and paths</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/06_actions"}}' role="menuitemradio" id="uniq1482182099817961" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/06_actions.html">Actions</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/07_providers"}}' role="menuitemradio" id="uniq1482182099817962" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/07_providers.html">Providers</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/08_operators"}}' role="menuitemradio" id="uniq1482182099817963" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/08_operators.html">Operators</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/09_factories"}}' role="menuitemradio" id="uniq1482182099817964" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/09_factories.html">Factories</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/10_connect"}}' role="menuitemradio" id="uniq1482182099817965" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/10_connect.html">Connect</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/11_computed"}}' role="menuitemradio" id="uniq1482182099817966" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/11_computed.html">Computed</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"in-depth/12_routing"}}' role="menuitemradio" id="uniq1482182099817967" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../in-depth/12_routing.html">Routing</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1482182099817968"><div class="menu__group-title" role="presentation" id="uniq1482182099817968">Best practices</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/01_organizing"}}' role="menuitemradio" id="uniq1482182099817969" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/01_organizing.html">Organizing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/02_constants"}}' role="menuitemradio" id="uniq1482182099817970" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/02_constants.html">Constants</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/03_testing"}}' role="menuitemradio" id="uniq1482182099817971" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/03_testing.html">Testing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/04_load-initial-data"}}' role="menuitemradio" id="uniq1482182099817972" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/04_load-initial-data.html">Load initial data</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/05_storing-server-data"}}' role="menuitemradio" id="uniq1482182099817973" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/05_storing-server-data.html">Storing server data</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/06_lists"}}' role="menuitemradio" id="uniq1482182099817974" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/06_lists.html">Lists</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/07_modals"}}' role="menuitemradio" id="uniq1482182099817975" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/07_modals.html">Modals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/08_feedback-message"}}' role="menuitemradio" id="uniq1482182099817976" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/08_feedback-message.html">Feedback messages</a></div><div class="menu-item menu-item_type_link menu-item_checked menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/09_popups"}}' role="menuitemradio" id="uniq1482182099817977" aria-checked="true"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/09_popups.html">Popups</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/10_long-running-side-effects"}}' role="menuitemradio" id="uniq1482182099817978" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/10_long-running-side-effects.html">Long running side effects</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"best-practices/11_server-side"}}' role="menuitemradio" id="uniq1482182099817979" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../best-practices/11_server-side.html">Server side</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1482182099817980"><div class="menu__group-title" role="presentation" id="uniq1482182099817980">Migration</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"migration/01_start_migration"}}' role="menuitemradio" id="uniq1482182099817981" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../migration/01_start_migration.html">From 1.x to 2.x</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1482182099817982"><div class="menu__group-title" role="presentation" id="uniq1482182099817982">API</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/01_controller"}}' role="menuitemradio" id="uniq1482182099817983" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/01_controller.html">Controller</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/02_state"}}' role="menuitemradio" id="uniq1482182099817984" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/02_state.html">State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/03_signals"}}' role="menuitemradio" id="uniq1482182099817985" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/03_signals.html">Signals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/04_connect"}}' role="menuitemradio" id="uniq1482182099817986" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/04_connect.html">Connect</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/05_modules"}}' role="menuitemradio" id="uniq1482182099817987" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/05_modules.html">Modules</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/06_operators"}}' role="menuitemradio" id="uniq1482182099817988" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/06_operators.html">Operators</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/07_providers"}}' role="menuitemradio" id="uniq1482182099817989" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/07_providers.html">Providers</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/08_router"}}' role="menuitemradio" id="uniq1482182099817990" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/08_router.html">Router</a></div></div></div></div></div><div class="row__col row__col_sw_24 row__col_lw_18 row__col_lo_1"><div class="page__edit"><a class="link link_theme_islands link__control i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral/tree/master/packages/docs/content/best-practices/09_popups.en.md">Edit on GitHub</a></div><h2 class="heading heading_lvl_2" id="popups">Popups</h2>
<p class="paragraph">Popups are different than modals. They are more in the realm of dropdowns, popup menus and even tooltips. What they share in behavior is that if you open one of them, the others should close. There are two approaches to this. You can create a stateful component handler for it, or you can use Cerebral and make it very explicit. There is no right answer, it depends on your application. But let us look at the Cerebral approach.</p>
<h3 class="heading heading_lvl_3" id="closing-everything">Closing everything</h3>
<p class="paragraph">First we need to close all these popup when we click our application. Let us create a chain that closes them:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token comment" spellcheck="true">// A specific popover</span>
  <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showSomePopover`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// A popover based on a userKey (dynamic)</span>
  <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.currentUserKeyPopover`</span></span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre>
<p class="paragraph">Now we register this chain to a signal on our <strong>app</strong> module:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> closePopovers <span class="token keyword">from</span> <span class="token string">'./chains/closePopovers'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    showSomePopover<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    currentUserKeyPopover<span class="token punctuation">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  signals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clicked<span class="token punctuation">:</span> closePopovers
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">And then in our root component we trigger the signal whenever we click our application:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  clicked<span class="token punctuation">:</span> <span class="token string">'app.clicked'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> App <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> props<span class="token punctuation">.</span><span class="token function">clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">...</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">Whenever we now click our application all our popups will close and we can see that behavior in the debugger as well.</p>
<h3 class="heading heading_lvl_3" id="prevent-closing">Prevent closing</h3>
<p class="paragraph">So when we now click a button to show a popover we have to ensure that our application does not trigger the click event on the root component, because then they will just close again. Let us imagine we have a signal that changes the <em>showSomePopover</em> state to <em>true</em> (showSomePopoverClicked).</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  showSomePopover<span class="token punctuation">:</span> <span class="token string">'app.showSomePopover'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  showSomePopoverClicked<span class="token punctuation">:</span> <span class="token string">'app.showSomePopoverClicked'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">MyPopover</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        props<span class="token punctuation">.</span><span class="token function">showSomePopoverClicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>div<span class="token operator">></span>
          Show popover
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token punctuation">{</span>
          props<span class="token punctuation">.</span>showSomePopoverClicked <span class="token operator">?</span>
            <span class="token operator">&lt;</span>div<span class="token operator">></span>Some popover<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
          <span class="token punctuation">:</span>
            <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">Using <strong>event.stopPropagation()</strong> we prevent any clicks on the button and the popover itself to propagate up to the application root component. So when our chain handling the popover click runs:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.showSomePopover`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre>
<p class="paragraph">We will show the popover. Clicking outside it will hide it. Now, you might want to close all the other popovers when you open a new one. Just compose it in:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> closePopovers <span class="token keyword">from</span> <span class="token string">'../chains/closePopovers'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token operator">...</span>closePopovers<span class="token punctuation">,</span>
  <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.somePopover`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre>
<p class="paragraph">So this gives you complete control of handling popups and you can make any kind of custom behavior to any of them.</p>
<h3 class="heading heading_lvl_3" id="dynamic-popups">Dynamic popups</h3>
<p class="paragraph">Sometimes you have a list where each item in the list should show a popup. In this case we want to dynamically open a popup. It is basically the same approach, but we use a state property that takes a reference to the current item instead:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> openItemPopover <span class="token keyword">from</span> <span class="token string">'./chains/openItemPopover'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    currentItemPopover<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    items<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'123'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'Some item'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">'456'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'Some other item'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  signals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    itemPopoverClicked<span class="token punctuation">:</span> openItemPopover
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p class="paragraph">So now let us imagine that we are dynamically building a list of items which contains a popover. For each item we create a new component:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  item<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`app.items.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>itemKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
  currentItemPopover<span class="token punctuation">:</span> <span class="token string">'app.currentItemPopover'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  itemPopoverClicked<span class="token punctuation">:</span> <span class="token string">'app.itemPopoverClicked'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">Item</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
          event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          props<span class="token punctuation">.</span><span class="token function">itemPopoverClicked</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            itemKey<span class="token punctuation">:</span> props<span class="token punctuation">.</span>itemKey
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>div<span class="token operator">></span>
            Show popover
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
          <span class="token punctuation">{</span>
            props<span class="token punctuation">.</span>currentItemPopover <span class="token operator">===</span> props<span class="token punctuation">.</span>itemKey <span class="token operator">?</span>
              <span class="token operator">&lt;</span>div<span class="token operator">></span>Some popover<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
            <span class="token punctuation">:</span>
              <span class="token keyword">null</span>
          <span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">What we do here is rather check if the current item popover matches the key of the item itself. So our <strong>openItemPopover</strong> chain would look something like:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>state<span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/operators'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token keyword">set</span><span class="token punctuation">(</span>state<span class="token template-string"><span class="token string">`app.currentItemPopover`</span></span><span class="token punctuation">,</span> input<span class="token template-string"><span class="token string">`itemKey`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre>
<p class="paragraph">Now you can again change this behavior. You might use an array instead to allow opening multiple popovers. But this is pretty much how you go about.</p>
<h3 class="heading heading_lvl_3" id="what-if-cerebral-is-inside-other-app-">What if Cerebral is inside other app?</h3>
<p class="paragraph">If your root component does not cover the whole browser you can rather listen to clicks on the window, using react as example:</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  someState<span class="token punctuation">:</span> <span class="token string">'app.someState'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  clicked<span class="token punctuation">:</span> <span class="token string">'app.clicked'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">></span>
          <span class="token operator">...</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<p class="paragraph">But now we are outside of React own event system. So when you click something you have to make sure that you stop propagating the native event, not React event.</p>
<pre><code class="code" class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cerebral/react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  showPopover<span class="token punctuation">:</span> <span class="token string">'app.showPopover'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  showPopoverClicked<span class="token punctuation">:</span> <span class="token string">'app.showPopoverClicked'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token function">MyPopover</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        event<span class="token punctuation">.</span>nativeEvent<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        props<span class="token punctuation">.</span><span class="token function">showPopoverClicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>div<span class="token operator">></span>
          Show popover
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token punctuation">{</span>
          props<span class="token punctuation">.</span>showPopover <span class="token operator">?</span>
            <span class="token operator">&lt;</span>div<span class="token operator">></span>Some popover<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
          <span class="token punctuation">:</span>
            <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
</div></div></div><footer class="footer page__footer"><div class="row"><div class="row__col row__col_sw_24 row__col_lw_6"><h4 class="footer__header">ORGANIZATION</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral/graphs/contributors">Contributors</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="http://www.webpackbin.com">www.webpackbin.com</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="http://www.christianalfoni.com">www.christianalfoni.com</a></div><div class="row__col row__col_sw_24 row__col_lw_6 row__col_lo_3"><h4 class="footer__header">ARTICLES AND USEFUL LINKS</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="http://medium.com/p/5793c08db2cc">The story of Cerebral</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://gist.github.com/christianalfoni/b08a99faa09df054afe87528a2134730">An unlikely success story</a></div><div class="row__col row__col_sw_24 row__col_lw_6 row__col_lo_6"><h4 class="footer__header">HELP</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral">Cerebral github repo</a><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="https://discord.gg/0kIweV4bd2bwwsvH">Discord chat</a></div></div></footer><script src="../js/scripts.min.js"></script></body></html>